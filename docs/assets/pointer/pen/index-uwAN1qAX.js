import"../../modulepreload-polyfill-B5Qt9EMX.js";import{b as k,p as M}from"../../util-DhqRJzH_.js";import{r as j}from"../../round-CDFh2_Rm.js";import{m as G,c as N}from"../../math-DVpWUKCU.js";import{e as O,d as V,i as J,a as U,p as Z}from"../../queue-fns-Cpl8E1uR.js";import{c as w}from"../../conversion-CGf7QoDW.js";import{s as Q}from"../../scale-KzsViUdl.js";import"../../result-aflA1LW7.js";import"../../numbers-SvRH5ijj.js";import"../../resolve-el-BUhvOf7L.js";import"../../StackFns-BOj2Sa9A.js";import"../../guard-RzpFIjKH.js";import"../../guard-DHhxSbUy.js";import"../../guard-BPeP3-pA.js";import"../../clamp-ClLuI7HB.js";import"../../guard-DRLb5kU_.js";import"../../arrays-Dsf3vC8Q.js";const $=o=>{if(typeof o!="number")throw new Error(`Param 'bipolarValue' must be a number. Got: ${typeof o}`);if(Number.isNaN(o))throw new Error("Param 'bipolarValue' is NaN");return o>1?1:o<-1?-1:o};class P{opts;#e;constructor(e={},r=[]){if(e===void 0)throw new Error("opts parameter undefined");this.opts=e,this.#e=r}forEach(e){for(let r=this.#e.length-1;r>=0;r--)e(this.#e[r])}forEachFromFront(e){this.#e.forEach(r=>{e(r)})}enqueue(...e){return new P(this.opts,O(this.opts,this.#e,...e))}dequeue(){return new P(this.opts,V(this.opts,this.#e))}get isEmpty(){return J(this.opts,this.#e)}get isFull(){return U(this.opts,this.#e)}get length(){return this.#e.length}get peek(){return Z(this.opts,this.#e)}toArray(){return[...this.#e]}}function B(o,e,r){const i=o.getAttribute(e);return i===null?r:Number.parseInt(i)}const _=(o,e={})=>{const r=document.querySelector(o);if(!r)throw new Error(`Element query could not be found (${o})`);const i=e.labels??["x","y"],y=e.labelPrecision??2,E=e.asPercentages??!1,g=e.displayLastValues??0,C=e.showWhiskers??!0,c=e.showDot??!0,S=e.showLabels??!0,A=e.yAxisBottomNegative??!0,L=w(e.axisColour,"silver"),d=w(e.bgColour,"white"),v=w(e.whiskerColour,"black"),u=w(e.dotColour,e.whiskerColour,"black"),K=w(e.labelColour,e.axisColour,"silver"),W=e.axisWidth??1*window.devicePixelRatio,X=e.dotRadius??5*window.devicePixelRatio,n=e.padding??10*window.devicePixelRatio,x=e.whiskerSize??5*window.devicePixelRatio,h=e.width??B(r,"width",200)*window.devicePixelRatio,m=e.height??B(r,"height",200)*window.devicePixelRatio;let a;g>0&&(a=new P({capacity:g,discardPolicy:"older"})),r.width=h,r.height=m,r.style.width=`${h/window.devicePixelRatio}px`,r.style.height=`${m/window.devicePixelRatio}px`;const b=m/2,p=h/2,t=r.getContext("2d");if(!t)throw new Error("Could not create drawing context");window.devicePixelRatio>=2&&(t.font="20px sans-serif");const q=E?s=>`${Math.round(s*100)}%`:s=>s.toFixed(y);S?(i[0]=i[0]+":",i[1]=i[1]+":"):(i[0]="",i[1]="");const Y=e.renderBackground??((s,l,f)=>{e.bgColour==="transparent"?s.clearRect(0,0,l,f):(s.fillStyle=d,s.fillRect(0,0,l,f))});return(s,l)=>{s=$(s),l=$(l),Y(t,h,m),t.fillStyle=K,t.textBaseline="top",t.save(),t.translate(p,b),t.rotate(-Math.PI/2),t.fillText((i[1]+" "+q(l)).trim(),-p+n,1),t.restore(),t.fillText((i[0]+" "+q(s)).trim(),n,p+2),A||(l*=-1),t.strokeStyle=L,t.lineWidth=W,t.beginPath(),t.moveTo(n,b),t.lineTo(h-n,b),t.moveTo(p,n),t.lineTo(p,m-n),t.stroke(),t.closePath();const f=(m-n-n)/2*-l,R=(h-n-n)/2*s,T={x:R,y:f,radius:X};if(a&&(a=a.enqueue(T)),t.save(),t.translate(p,b),c)if(a){const H=1/a.length;let F=1;a.forEach(D=>{const I=G(u,F);N(t,D,{fillStyle:I}),F-=H})}else N(t,T,{fillStyle:u});C&&(t.strokeStyle=v,t.beginPath(),t.moveTo(0,f-x),t.lineTo(0,f+x),t.moveTo(R-x,0),t.lineTo(R+x,0),t.stroke(),t.closePath()),t.restore()}},z={tiltScale:Q(-90,90,-1,1),tiltPlot:_("#plotTilt",{yAxisBottomNegative:!1,bgColour:"transparent",axisColour:"greenyellow",whiskerColour:"white",labelColour:"--fg",displayLastValues:50}),rounder:j(2),penEl:document.querySelector("#penArea"),helpEl:document.querySelector("#helpArea"),eventKeys:"width height pointerType tiltX tiltY twist tangentialPressure pointerId x y movementX movementY".split(" ")},ee=o=>{const{eventKeys:e,rounder:r,tiltPlot:i,tiltScale:y}=z,{shiftKey:E,metaKey:g,ctrlKey:C}=o;for(const d of e){const v=document.querySelector(`#${d}`);if(v!==null){const u=o[d];v.textContent=typeof u=="number"?r(u).toString():u}}const c=[];E&&c.push("shift"),g&&c.push("meta"),C&&c.push("ctrl");const S=c.map(d=>`<kbd>${d}</kbd>`).join(" ");k("keys",S),k("pressure",M(o.pressure));const A=o.altitudeAngle??0,L=o.azimuthAngle??0;k("altitudeAngle",r(A)),k("azimuthAngle",r(L)),i(y(o.tiltX),y(o.tiltY))},te=()=>{const{penEl:o,helpEl:e}=z;o&&(o.addEventListener("pointermove",r=>{ee(r)}),o.addEventListener("pointerenter",r=>{}),o.addEventListener("pointerleave",r=>{}),o.addEventListener("pointercancel",r=>{}),o.addEventListener("pointerover",r=>{}),o.addEventListener("pointerdown",r=>{}),o.addEventListener("pointerup",r=>{}),document.querySelector("#btnHelpClose")?.addEventListener("click",()=>{e&&(e.style.display="none")}),document.querySelector("#btnHelpShow")?.addEventListener("click",()=>{e&&(e.style.display="block")}))};te();
