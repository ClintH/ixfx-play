import{c as p,n as v,_ as y,s as pe,d as me,e as ve,g as ge,h as M,j as T}from"./src-BeVDUOoq-B6OoJ3p3.js";import{l as I,r as ye,m as we,o as w,p as be,q as C,u as X,E as u,v as g,x as h,y as S,z as R,A as P,B as Ee,C as G,F as Ae,G as U,H as ke,I as Ie,J as Le,c as W,Q as D,R as Me,U as Ne,S as Oe,T as Y,V as H,W as Z,X as Te,Y as Pe,Z as $e,_ as De,$ as Fe,a0 as F,a1 as B,a2 as Be}from"./src-C7XtfIer-DYL4nwfS.js";function Se(e,t={}){p(ge(e,"aboveZero","totalTicks"));const n=t.exclusiveStart??!1,s=t.exclusiveEnd??!1,r=t.cycleLimit??Number.MAX_SAFE_INTEGER,i=n?1:0,a=s?e-1:e;let o=0,c=t.startAt??i;if(t.startAtRelative){let l=e;n&&l--,s&&l--,c=Math.round(t.startAtRelative*l)}return l=>{if(l&&(l.resetAt!==void 0&&(c=l.resetAt),l.resetAtRelative!==void 0&&(c=Math.floor(l.resetAtRelative*e))),o>=r)return 1;const m=c/e;return c++,c>a&&(o++,c=i),m}}function _(e,t={}){const n=t.cycleLimit??Number.MAX_SAFE_INTEGER,s=1;let r=t.startAt??performance.now(),i=0;const a=W(e,1e3);return t.startAtRelative&&(p(v(t.startAtRelative,"percentage","startAtRelative")),r=performance.now()-a*t.startAtRelative),o=>{if(o&&(o.resetAt!==void 0&&(r=o.resetAt,r===0&&(r=performance.now())),o.resetAtRelative!==void 0&&(p(v(o.resetAtRelative,"percentage","resetAtRelative")),r=performance.now()-a*o.resetAtRelative)),i>=n)return s;const c=performance.now(),l=c-r;return l>=a&&(i+=Math.floor(l/a),r=c,i>=n)?s:l%a/a}}function Re(e,t={}){const n=6e4/e;return _(n,t)}function _e(e,t={}){const n=1e3/e;return _(n,t)}const J=(e,t={})=>{const n=e/1e3;let s=t.min??Number.MIN_SAFE_INTEGER,r=t.max??Number.MAX_SAFE_INTEGER;const i=t.clamp??!1;if(i&&t.max)throw new Error("Use either 'max' or 'clamp', not both.");i&&(r=e);let a=performance.now();return()=>{const o=performance.now(),c=o-a;a=o;const l=n*c;return l>r?r:l<s?s:l}},Ve=(e,t={})=>J(e/60,t);var ze={};y(ze,{bpm:()=>Re,elapsed:()=>_,hertz:()=>_e,perMinute:()=>Ve,perSecond:()=>J,ticks:()=>Se});var je={};y(je,{saw:()=>Ge,sine:()=>qe,sineBipolar:()=>Ce,square:()=>Ue,triangle:()=>Xe});const Q=Math.PI*2;function*qe(e){if(e===void 0)throw new TypeError("Parameter 'timerOrFreq' is undefined");for(typeof e=="number"&&(e=I(e));;)yield(Math.sin(e.elapsed*Q)+1)/2}function*Ce(e){if(e===void 0)throw new TypeError("Parameter 'timerOrFreq' is undefined");for(typeof e=="number"&&(e=I(e));;)yield Math.sin(e.elapsed*Q)}function*Xe(e){for(typeof e=="number"&&(e=I(e));;){let t=e.elapsed;t<.5?t*=2:t=2-t*2,yield t}}function*Ge(e){if(e===void 0)throw new TypeError("Parameter 'timerOrFreq' is undefined");for(typeof e=="number"&&(e=I(e));;)yield e.elapsed}function*Ue(e){for(typeof e=="number"&&(e=I(e));;)yield e.elapsed<.5?0:1}const We=Math.pow,Ye=1/Math.sqrt(2*Math.PI),He=(e=.4)=>n=>{const s=Ye/e;let r=-2.5,i=(n-.5)/e;i*=i,r*=i;const a=s*We(Math.E,r);return a>1?1:a<0?0:a};var V={};y(V,{arch:()=>Qe,backIn:()=>vt,backInOut:()=>wt,backOut:()=>gt,bell:()=>kt,bounceIn:()=>At,bounceInOut:()=>Lt,bounceOut:()=>O,circIn:()=>pt,circInOut:()=>yt,circOut:()=>mt,cubicIn:()=>at,cubicOut:()=>ot,elasticIn:()=>bt,elasticInOut:()=>It,elasticOut:()=>Et,expoIn:()=>ut,expoInOut:()=>ht,expoOut:()=>ft,quadIn:()=>nt,quadInOut:()=>it,quadOut:()=>rt,quartIn:()=>ct,quartOut:()=>lt,quintIn:()=>Ze,quintInOut:()=>dt,quintOut:()=>Je,sineIn:()=>et,sineInOut:()=>st,sineOut:()=>tt,smootherstep:()=>xe,smoothstep:()=>Ke});const N=Math.sqrt,f=Math.pow,K=Math.cos,b=Math.PI,k=Math.sin,O=e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,Ze=e=>e*e*e*e*e,Je=e=>1-f(1-e,5),Qe=e=>e*(1-e)*4,Ke=e=>e*e*(3-2*e),xe=e=>(e*(e*6-15)+10)*e*e*e,et=e=>1-K(e*b/2),tt=e=>k(e*b/2),nt=e=>e*e,rt=e=>1-(1-e)*(1-e),st=e=>-(K(b*e)-1)/2,it=e=>e<.5?2*e*e:1-f(-2*e+2,2)/2,at=e=>e*e*e,ot=e=>1-f(1-e,3),ct=e=>e*e*e*e,lt=e=>1-f(1-e,4),ut=e=>e===0?0:f(2,10*e-10),ft=e=>e===1?1:1-f(2,-10*e),dt=e=>e<.5?16*e*e*e*e*e:1-f(-2*e+2,5)/2,ht=e=>e===0?0:e===1?1:e<.5?f(2,20*e-10)/2:(2-f(2,-20*e+10))/2,pt=e=>1-N(1-f(e,2)),mt=e=>N(1-f(e-1,2)),vt=e=>2.70158*e*e*e-1.70158*e*e,gt=e=>1+2.70158*f(e-1,3)+1.70158*f(e-1,2),yt=e=>e<.5?(1-N(1-f(2*e,2)))/2:(N(1-f(-2*e+2,2))+1)/2,wt=e=>{const n=2.5949095;return e<.5?f(2*e,2)*((n+1)*2*e-n)/2:(f(2*e-2,2)*((n+1)*(e*2-2)+n)+2)/2},bt=e=>{const t=2*b/3;return e===0?0:e===1?1:-f(2,10*e-10)*k((e*10-10.75)*t)},Et=e=>{const t=2*b/3;return e===0?0:e===1?1:f(2,-10*e)*k((e*10-.75)*t)+1},At=e=>1-O(1-e),kt=He(),It=e=>{const t=2*b/4.5;return e===0?0:e===1?1:e<.5?-(f(2,20*e-10)*k((20*e-11.125)*t))/2:f(2,-20*e+10)*k((20*e-11.125)*t)/2+1},Lt=e=>e<.5?(1-O(1-2*e))/2:(1+O(2*e-1))/2,Mt=(e=0,t=0)=>{const s={x:M(e,-1,1,0,1),y:M(e,-1,1,1,0)};let r=D(Math.abs(e),u,s);e!==0&&t>0&&(e>0?r=D(t,r,{x:0,y:s.x*2}):r=D(t,r,{x:s.y*2,y:0}));const i=Me(u,Ne,r,s),a=Oe(i);return o=>a(o)},Nt=(e,t)=>{p(T(e,"fn"));let n;return()=>(typeof n>"u"&&(n=Te(t,{clampValue:!0})),e(n()))},Ot=(e,t)=>{p(T(e,"fn"));const n=Y(),s=W(t);if(s===void 0)throw new Error("Param 'duration' not provided");const r=H(s,{timer:n,clampValue:!0});return Z(e,r)},Tt=(e,t)=>{p(T(e,"fn"));let n;return()=>(typeof n>"u"&&(n=Pe(t,{clampValue:!0})),e(n()))},Pt=(e,t)=>{p(T(e,"fn"));const n=$e(),s=H(t,{timer:n,clampValue:!0});return Z(e,s)};var $t={};y($t,{Named:()=>V,create:()=>Dt,get:()=>te,getEasingNames:()=>St,line:()=>Mt,tickEasing:()=>Bt,ticks:()=>ee,time:()=>x,timeEasing:()=>Ft});const Dt=e=>{const n=L(e.name??"quintIn")??e.fn;if(typeof n>"u")throw new Error("Either 'name' or 'fn' must be set");if("duration"in e)return x(n,e.duration);if("ticks"in e)return ee(n,e.ticks);throw new Error("Expected 'duration' or 'ticks' in options")},Ft=(e,t)=>{const n=L(e);return Ot(n,t)},x=(e,t)=>{const n=L(e);return Nt(n,t)},ee=(e,t)=>{const n=L(e);return Tt(n,t)},Bt=(e,t)=>{const n=L(e);return Pt(n,t)},L=e=>{const t=typeof e=="function"?e:te(e);if(typeof t>"u")throw typeof e=="string"?new Error(`Easing function not found: '${e}'`):new Error("Easing function not found");return t};let E;const te=function(e){p(pe(e,"non-empty","easingName"));const t=ne().get(e.toLowerCase());if(t===void 0)throw new Error(`Easing not found: '${e}'`);return t};function ne(){if(E===void 0){E=new Map;for(const[e,t]of Object.entries(V))E.set(e.toLowerCase(),t);return E}else return E}function*St(){yield*ne().keys()}const re=Object.freeze({attack:["decay","release"],decay:["sustain","release"],sustain:["release"],release:["complete"],complete:null}),A=Object.freeze({attackDuration:600,decayDuration:200,releaseDuration:800,shouldLoop:!1});var se=class extends De{#e;#s;#t;#r;#n;#i=!1;#a=!1;attackDuration;decayDuration;releaseDuration;decayDurationTotal;shouldLoop;constructor(e={}){super(),this.attackDuration=e.attackDuration??A.attackDuration,this.decayDuration=e.decayDuration??A.decayDuration,this.releaseDuration=e.releaseDuration??A.releaseDuration,this.shouldLoop=e.shouldLoop??A.shouldLoop,this.#e=new Fe(re,{initial:"attack"}),this.#e.addEventListener("change",t=>{t.newState==="release"&&this.#n&&this.#t?.reset(),super.fireEvent("change",t)}),this.#e.addEventListener("stop",t=>{super.fireEvent("complete",t)}),this.#s=()=>Y(),this.#r=this.#n=!1,this.decayDurationTotal=this.attackDuration+this.decayDuration}dispose(){this.#i||this.#e.dispose()}get isDisposed(){return this.#i}switchStateIfNeeded(e){if(this.#t===void 0)return!1;let t=this.#t.elapsed;const n=this.#n&&!this.#r;let s=!1,r=this.#e.state;do switch(s=!1,r=this.#e.state,r){case"attack":{(t>this.attackDuration||n)&&(this.#e.next(),s=!0);break}case"decay":{(t>this.decayDurationTotal||n)&&(this.#e.next(),s=!0);break}case"sustain":{(!this.#r||n)&&(t=0,this.#e.next(),this.#t.reset(),s=!0);break}case"release":{t>this.releaseDuration&&(this.#e.next(),s=!0);break}case"complete":this.shouldLoop&&e&&this.trigger(this.#n)}while(s&&r!=="complete");return s}computeRaw(e=!0,t=!0){if(this.#t===void 0)return[void 0,0,this.#e.state];e&&this.switchStateIfNeeded(t);const n=this.#e.state,s=this.#t.elapsed;let r=0;const i=this.#e.state;switch(i){case"attack":{r=s/this.attackDuration;break}case"decay":{r=(s-this.attackDuration)/this.decayDuration;break}case"sustain":{r=1;break}case"release":{r=Math.min(s/this.releaseDuration,1);break}case"complete":return["complete",1,n];default:throw new Error(`State machine in unknown state: ${i}`)}return[i,r,n]}get isDone(){return this.#e.isDone}onTrigger(){}trigger(e=!1){this.onTrigger(),this.#a=!0,this.#e.reset(),this.#t=this.#s(),this.#r=e,this.#n=e}get hasTriggered(){return this.#a}compute(){}release(){this.isDone||!this.#n||(this.#r=!1,this.compute())}};const d=Object.freeze({attackBend:-1,decayBend:-.3,releaseBend:-.3,peakLevel:1,initialLevel:0,sustainLevel:.6,releaseLevel:0,retrigger:!1});var ie=class{constructor(e){this.adsr=e}next(...e){this.adsr.hasTriggered||this.adsr.trigger();const t=this.adsr.compute();return{value:t[1],done:t[0]==="complete"}}get[Symbol.toStringTag](){return"Generator"}},z=class extends se{attackPath;decayPath;releasePath;initialLevel;peakLevel;releaseLevel;sustainLevel;attackBend;decayBend;releaseBend;initialLevelOverride;retrigger;releasedAt;constructor(e={}){super(e),this.retrigger=e.retrigger??d.retrigger,this.initialLevel=e.initialLevel??d.initialLevel,this.peakLevel=e.peakLevel??d.peakLevel,this.releaseLevel=e.releaseLevel??d.releaseLevel,this.sustainLevel=e.sustainLevel??d.sustainLevel,this.attackBend=e.attackBend??d.attackBend,this.releaseBend=e.releaseBend??d.releaseBend,this.decayBend=e.decayBend??d.decayBend;const t=1;this.attackPath=F(B({x:0,y:this.initialLevel},{x:t,y:this.peakLevel},-this.attackBend)),this.decayPath=F(B({x:0,y:this.peakLevel},{x:t,y:this.sustainLevel},-this.decayBend)),this.releasePath=F(B({x:0,y:this.sustainLevel},{x:t,y:this.releaseLevel},-this.releaseBend))}onTrigger(){if(this.initialLevelOverride=void 0,!this.retrigger){const[e,t,n]=this.compute(!0,!1);!Number.isNaN(t)&&t>0&&(this.initialLevelOverride=t)}}[Symbol.iterator](){return new ie(this)}get value(){return this.compute(!0)[1]}compute(e=!0,t=!0){const[n,s]=super.computeRaw(e,t);if(n===void 0)return[void 0,NaN,NaN];let r;switch(n){case"attack":{r=this.attackPath.interpolate(s).y,this.initialLevelOverride!==void 0&&(r=M(r,0,1,this.initialLevelOverride,1)),this.releasedAt=r;break}case"decay":{r=this.decayPath.interpolate(s).y,this.releasedAt=r;break}case"sustain":{r=this.sustainLevel,this.releasedAt=r;break}case"release":{r=this.releasePath.interpolate(s).y,this.releasedAt!==void 0&&(r=M(r,0,this.sustainLevel,0,this.releasedAt));break}case"complete":{r=this.releaseLevel,this.releasedAt=void 0;break}default:throw new Error(`Unknown state: ${n}`)}return[n,r,s]}},Rt={};y(Rt,{Adsr:()=>z,AdsrBase:()=>se,AdsrIterator:()=>ie,adsr:()=>_t,adsrIterable:()=>Vt,adsrStateTransitions:()=>re,defaultAdsrOpts:()=>d,defaultAdsrTimingOpts:()=>A});const _t=(e={})=>{const t=new z(e),n=t.releaseLevel,s=t[Symbol.iterator]();return()=>ye(s,{overrideWithLast:!0,value:n})};async function*Vt(e){const t=new z(e.env),n=e.sampleRateMs??100;t.trigger();const s=we(()=>t.value,{while:()=>!t.isDone,delay:n,signal:e.signal});for await(const r of s)yield r}var zt={};y(zt,{accelerationForce:()=>Ut,angleFromAccelerationForce:()=>ce,angleFromVelocityForce:()=>le,angularForce:()=>oe,apply:()=>Gt,attractionForce:()=>Ct,computeAccelerationToTarget:()=>ue,computeAttractionForce:()=>ae,computePositionFromAngle:()=>fe,computePositionFromVelocity:()=>q,computeVelocity:()=>j,constrainBounce:()=>qt,guard:()=>jt,magnitudeForce:()=>Wt,nullForce:()=>Yt,orientationForce:()=>xt,pendulumForce:()=>Jt,springForce:()=>Zt,targetForce:()=>Xt,velocityForce:()=>Ht});const jt=(e,t="t")=>{if(e===void 0)throw new Error(`Parameter ${t} is undefined. Expected ForceAffected`);if(e===null)throw new Error(`Parameter ${t} is null. Expected ForceAffected`);if(typeof e!="object")throw new TypeError(`Parameter ${t} is type ${typeof e}. Expected object of shape ForceAffected`)},qt=(e,t=1)=>{e||(e={width:1,height:1});const n=C(e,"left"),s=C(e,"right"),r=X(e,"top"),i=X(e,"bottom");return a=>{const o=q(a.position??u,a.velocity??u);let c=a.velocity??u,{x:l,y:m}=o;return l>s?(l=s,c=g(h(c,t),"x")):l<n&&(l=n,c=g(h(c,t),"x")),m>i?(m=i,c=h(g(c,"y"),t)):o.y<r&&(m=r,c=g(h(c,t),"y")),Object.freeze({...a,position:{x:l,y:m},velocity:c})}},Ct=(e,t,n={})=>s=>{let r=s.acceleration??u;for(const i of e){if(i===s)continue;const a=ae(i,s,t,n);r=w(r,a)}return{...s,acceleration:r}},ae=(e,t,n,s={})=>{if(e.position===void 0)throw new Error("attractor.position not set");if(t.position===void 0)throw new Error("attractee.position not set");const r=s.min??.01,i=s.max??.7,a=S(R(e.position,t.position)),o=me(P(a),r,i);return h(a,n*(e.mass??1)*(t.mass??1)/(o*o))},Xt=(e,t={})=>s=>{const r=ue(e,s.position??{x:.5,y:.5},t);return{...s,acceleration:w(s.acceleration??u,r)}},Gt=(e,...t)=>{if(e===void 0)throw new Error("t parameter is undefined");for(const i of t)i!=null&&(e=typeof i=="function"?i(e):{...e,acceleration:w(e.acceleration??u,i)});const n=j(e.acceleration??u,e.velocity??u),s=q(e.position??u,n);return{...e,position:s,velocity:n,acceleration:u}},Ut=(e,t="ignored")=>n=>Object.freeze({...n,acceleration:$(e,n,t)}),$=(e,t,n="ignored")=>{let s;switch(n){case"dampen":{s=r=>Be(e,r,r);break}case"multiply":{s=r=>U(e,r,r);break}case"ignored":{s=r=>e;break}default:throw new Error(`Unknown 'mass' parameter '${n}. Expected 'dampen', 'multiply' or 'ignored'`)}return w(t.acceleration??u,s(t.mass??1))},Wt=(e,t="ignored")=>n=>{if(n.velocity===void 0)return n;const s=P(S(n.velocity)),r=e*s*s,i=h(g(n.velocity),r);return Object.freeze({...n,acceleration:$(i,n,t)})},Yt=e=>e,Ht=(e,t)=>{const n=Ee(g,s=>h(s,e));return s=>{if(s.velocity===void 0)return s;const r=n(s.velocity);return Object.freeze({...s,acceleration:$(r,s,t)})}},oe=()=>e=>{const t=e.angularAcceleration??0,n=e.angularVelocity??0,s=e.angle??0,r=n+t,i=s+r;return Object.freeze({...e,angle:i,angularVelocity:r,angularAcceleration:0})},ce=(e=20)=>t=>{const n=t.acceleration??u;return Object.freeze({...t,angularAcceleration:n.x*e})},le=(e=1)=>t=>{const n=G(t.velocity??u);return Object.freeze({...t,angle:e<1?ve(e,t.angle??0,n):n})},Zt=(e,t=.5,n=2e-4,s=.999)=>r=>{const i=R(r.position??u,e),a=P(i),o=Math.abs(t-a),c=Ae(i,S,he=>h(he,-n*o)),l=$(c,r,"dampen"),m=j(l??u,r.velocity??u),de=U(m,s,s);return{...r,velocity:de,acceleration:u}},Jt=(e,t={})=>n=>{e||(e={x:0,y:0});const s=t.length??P(e,n.position??u),r=t.speed??.001,i=t.damping??.995;let a=n.angle;a===void 0&&(n.position?a=G(e,n.position)-Math.PI/2:a=0);const o=-1*r/s*Math.sin(a),c=(n.angularVelocity??0)+o;return a+=c,Object.freeze({angularVelocity:c*i,angle:a,position:fe(s,a+Math.PI/2,e)})},j=(e,t,n)=>{const s=w(t,e);return n===void 0?s:ke(s,n)},ue=(e,t,n={})=>{const s=n.diminishBy??.001,r=R(e,t);return n.range&&Ie(Le(r),n.range)===-2?u:h(r,s)},q=(e,t)=>w(e,t),fe=(e,t,n)=>be(e,t,n),Qt=oe(),Kt=ce(),xt=(e=.5)=>{const t=le(e);return n=>(n=Qt(n),n=Kt(n),n=t(n),n)},rn=function(e=.1,t,n,s,r){return typeof t>"u"&&(t=0),typeof n>"u"&&(n=1),typeof s>"u"&&(s=t),p(v(e,"bipolar","interval"),v(n,"bipolar","end"),v(s,"bipolar","offset"),v(t,"bipolar","start")),en(e,t,n,s,r)},en=function*(e,t,n,s,r){if(t===void 0)throw new Error("Parameter 'lower' is undefined");if(e===void 0)throw new Error("Parameter 'interval' is undefined");if(n===void 0)throw new Error("Parameter 'upper' is undefined");if(r===void 0&&e<=1&&e>=0?r=10/e:typeof r>"u"&&(r=1234),Number.isNaN(e))throw new Error("interval parameter is NaN");if(Number.isNaN(t))throw new Error("lower parameter is NaN");if(Number.isNaN(n))throw new Error("upper parameter is NaN");if(Number.isNaN(s))throw new Error("upper parameter is NaN");if(t>=n)throw new Error("lower must be less than upper");if(e===0)throw new Error("Interval cannot be zero");const i=n-t;if(Math.abs(e)>=i)throw new Error(`Interval should be between -${i} and ${i}`);let a=e>0;if(n=Math.floor(n*r),t=Math.floor(t*r),e=Math.floor(Math.abs(e*r)),e===0)throw new Error(`Interval is zero (rounding: ${r})`);if(s=s===void 0?t:Math.floor(s*r),s>n||s<t)throw new Error(`Start (${s/r}) must be within lower (${t/r}) and upper (${n/r})`);let o=s;yield o/r;let c=!0;for(;;)o=o+(a?e:-e),a&&o>=n?(a=!1,o=n,o===n&&c&&(o=t,a=!0)):!a&&o<=t&&(a=!0,o=t,o===t&&c&&(o=n,a=!1)),yield o/r,c=!1};export{Rt as e,rn as p};
