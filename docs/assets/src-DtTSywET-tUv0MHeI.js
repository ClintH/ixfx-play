import{c as D,J as F,P as I,n as N,_ as P,Q as Un,N as On,d as ee,f as L,R as hr,D as et,C as Kn,T as Xn,U as Jn,S as Zn}from"./src-BeVDUOoq-B6OoJ3p3.js";import{b as Qn}from"./records-Cei7yF1D-Dejnhz0L.js";import{bh as pr,bi as mr,bj as es,aY as xr,bo as kr,bp as Sr,bq as ts,br as rs,bs as fr,bt as ns,bu as ss,bv as is,e as as,bw as os,bx as ur,bk as ls,bm as cs,bn as dr,bl as vr,by as hs,bz as fs,aZ as Cr,b2 as us,z as Ar,bD as ds,bA as gs,bB as bs,bC as ys,_ as ws,bd as Je,a_ as ps,be as ms,bf as xs,bg as ks}from"./src-C7XtfIer-DYL4nwfS.js";import{r as he,E as tt,a as Ss}from"./src-sHR31-XU-C1xj0KeO.js";var $r={};P($r,{arc:()=>Er,bezier:()=>Ir,circle:()=>rt,connectedPoints:()=>ft,copyToImg:()=>Ts,dot:()=>B,drawingStack:()=>xe,ellipse:()=>$s,getContext:()=>Tr,line:()=>Ft,lineThroughPoints:()=>As,makeHelper:()=>Pr,paths:()=>Nr,pointLabels:()=>ut,rect:()=>nt,textBlock:()=>Lr,textBlockAligned:()=>Ms,textHeight:()=>Is,textRect:()=>Ht,textWidth:()=>Ns,translatePoint:()=>Rs,triangle:()=>Es});const Rr=Math.PI*2,Tr=e=>{if(e===null)throw new Error("canvasElCtxOrQuery null. Must be a 2d drawing context or Canvas element");if(e===void 0)throw new Error("canvasElCtxOrQuery undefined. Must be a 2d drawing context or Canvas element");const t=e instanceof CanvasRenderingContext2D?e:e instanceof HTMLCanvasElement?e.getContext("2d"):typeof e=="string"?he(e).getContext("2d"):e;if(t===null)throw new Error("Could not create 2d context for canvas");return t},Pr=(e,t)=>{const r=Tr(e);return{ctx:r,paths(n,s){Nr(r,n,s)},line(n,s){Ft(r,n,s)},rect(n,s){nt(r,n,s)},bezier(n,s){Ir(r,n,s)},connectedPoints(n,s){ft(r,n,s)},pointLabels(n,s){ut(r,n,s)},dot(n,s){B(r,n,s)},circle(n,s){rt(r,n,s)},arc(n,s){Er(r,n,s)},textBlock(n,s){s.bounds===void 0&&t!==void 0&&(s={...s,bounds:{...t,x:0,y:0}}),Lr(r,n,s)}}},zt=e=>vs(e.strokeStyle,e.fillStyle),$=(e,t={},...r)=>{if(e===void 0)throw new Error("ctx undefined");const n=xe(e).push(zt(t),...r);return n.apply(),n},Er=(e,t,r={})=>{$(e,r);const n=i=>{e.beginPath(),e.arc(i.x,i.y,i.radius,i.startRadian,i.endRadian),e.stroke()},s=Array.isArray(t)?t:[t];for(const i of s)n(i)},vs=(e,t)=>n=>{t&&(n.fillStyle=t),e&&(n.strokeStyle=e)},Cs=(e,t,r)=>s=>{e&&(s.lineWidth=e),t&&(s.lineJoin=t),r&&(s.lineCap=r)},xe=(e,t)=>(t??=new dr,{push:(...i)=>{t??=new dr;const a=t.push(...i);for(const l of i)l(e);return xe(e,a)},pop:()=>{const i=t?.pop();return xe(e,i)},apply:()=>{if(t===void 0)return xe(e);for(const i of t.data)i(e);return xe(e,t)}}),As=(e,t,r)=>{$(e,r),e.moveTo(t[0].x,t[0].y);for(const[n,s]of t.entries()){if(n+2>=t.length)continue;const i=t[n+1],a={x:(s.x+i.x)/2,y:(s.y+i.y)/2},l=(a.x+s.x)/2,o=(a.x+i.x)/2;e.quadraticCurveTo(l,i.y,a.x,a.y),e.quadraticCurveTo(o,i.y,i.x,i.y)}},rt=(e,t,r={})=>{$(e,r);const n=s=>{e.beginPath(),e.arc(s.x,s.y,s.radius,0,Rr),r.strokeStyle&&e.stroke(),r.fillStyle&&e.fill()};if(Array.isArray(t))for(const s of t)n(s);else n(t)},$s=(e,t,r={})=>{$(e,r);const n=i=>{e.beginPath();const a=i.rotation??0,l=i.startAngle??0,o=i.endAngle??Rr;e.ellipse(i.x,i.y,i.radiusX,i.radiusY,a,l,o),r.strokeStyle&&e.stroke(),r.fillStyle&&e.fill()},s=Array.isArray(t)?t:[t];for(const i of s)n(i)},Nr=(e,t,r={})=>{$(e,r);const n=s=>{if(mr(s))Mr(e,s,r);else if(cs(s))Ft(e,s,r);else throw new Error(`Unknown path type ${JSON.stringify(s)}`)};if(Array.isArray(t))for(const s of t)n(s);else n(t)},ft=(e,t,r={})=>{const n=r.loop??!1;if(D(Un(t,"pts")),t.length!==0){for(const[s,i]of t.entries())pr(i,`Index ${s}`);$(e,r),r.lineWidth&&(e.lineWidth=r.lineWidth),e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const s of t)e.lineTo(s.x,s.y);n&&e.lineTo(t[0].x,t[0].y),(r.strokeStyle||r.strokeStyle===void 0&&r.fillStyle===void 0)&&e.stroke(),r.fillStyle&&e.fill()}},ut=(e,t,r={},n)=>{if(t.length!==0){for(const[s,i]of t.entries())pr(i,`Index ${s}`);$(e,r);for(const[s,i]of t.entries()){const a=n!==void 0&&s<n.length?n[s]:s.toString();e.fillText(a.toString(),i.x,i.y)}}},Rs=(e,t)=>{const r=e.getTransform();return{x:t.x*r.a+t.y*r.c+r.e,y:t.x*r.b+t.y*r.d+r.f}},Ts=e=>{const t=document.createElement("img");return t.src=e.toDataURL("image/jpeg"),t},B=(e,t,r)=>{r??={};const n=r.radius??10,s=Array.isArray(t)?t:[t],i=r.stroke?r.stroke:r.strokeStyle!==void 0;let a=r.filled?r.filled:r.fillStyle!==void 0;!i&&!a&&(a=!0),$(e,r);for(const l of s)e.beginPath(),"radius"in l?e.arc(l.x,l.y,l.radius,0,2*Math.PI):e.arc(l.x,l.y,n,0,2*Math.PI),a&&e.fill(),i&&e.stroke()},Ir=(e,t,r)=>{mr(t)?Mr(e,t,r):es(t)&&Ps(e,t,r)},Ps=(e,t,r={})=>{let n=$(e,r);const{a:s,b:i,cubic1:a,cubic2:l}=t,o=r.debug??!1;e.beginPath(),e.moveTo(s.x,s.y),e.bezierCurveTo(a.x,a.y,l.x,l.y,i.x,i.y),e.stroke(),o&&(n=n.push(zt({...r,strokeStyle:Ae(r.strokeStyle??"silver",.6),fillStyle:Ae(r.fillStyle??"yellow",.4)})),n.apply(),e.moveTo(s.x,s.y),e.lineTo(a.x,a.y),e.stroke(),e.moveTo(i.x,i.y),e.lineTo(l.x,l.y),e.stroke(),e.fillText("a",s.x+5,s.y),e.fillText("b",i.x+5,i.y),e.fillText("c1",a.x+5,a.y),e.fillText("c2",l.x+5,l.y),B(e,a,{radius:3}),B(e,l,{radius:3}),B(e,s,{radius:3}),B(e,i,{radius:3}),n=n.pop(),n.apply())},Mr=(e,t,r={})=>{const{a:n,b:s,quadratic:i}=t,a=r.debug??!1;let l=$(e,r);e.beginPath(),e.moveTo(n.x,n.y),e.quadraticCurveTo(i.x,i.y,s.x,s.y),e.stroke(),a&&(l=l.push(zt({...r,strokeStyle:Ae(r.strokeStyle??"silver",.6),fillStyle:Ae(r.fillStyle??"yellow",.4)})),ft(e,[n,i,s]),e.fillText("a",n.x+5,n.y),e.fillText("b",s.x+5,s.y),e.fillText("h",i.x+5,i.y),B(e,i,{radius:3}),B(e,n,{radius:3}),B(e,s,{radius:3}),l=l.pop(),l.apply())},Ft=(e,t,r={})=>{const n=r.debug??!1,s=Cs(r.lineWidth,r.lineJoin,r.lineCap);$(e,r,s);const i=a=>{const{a:l,b:o}=a;e.beginPath(),e.moveTo(l.x,l.y),e.lineTo(o.x,o.y),n&&(e.fillText("a",l.x,l.y),e.fillText("b",o.x,o.y),B(e,l,{radius:5,strokeStyle:"black"}),B(e,o,{radius:5,strokeStyle:"black"})),e.stroke()};if(Array.isArray(t))for(const a of t)i(a);else i(t)},Es=(e,t,r={})=>{$(e,r);const n=s=>{ft(e,ur(s),{...r,loop:!0}),r.debug&&ut(e,ur(s),void 0,["a","b","c"])};if(Array.isArray(t))for(const s of t)n(s);else n(t)},nt=(e,t,r={})=>{$(e,r);const n=r.filled??r.fillStyle!==void 0,s=r.stroke??r.strokeStyle!==void 0,i=a=>{const l="x"in a?a.x:0,o="y"in a?a.y:0;n&&e.fillRect(l,o,a.width,a.height),s&&(r.strokeWidth&&(e.lineWidth=r.strokeWidth),e.strokeRect(l,o,a.width,a.height)),r.crossed&&(e.beginPath(),e.moveTo(l,o),e.lineTo(a.width,a.height),e.stroke(),e.moveTo(0,a.height),e.lineTo(a.width,0),e.stroke()),r.debug&&ut(e,ls(a),void 0,["NW","NE","SE","SW"])};if(Array.isArray(t))for(const a of t)i(a);else i(t)},Ns=(e,t,r=0,n)=>Ht(e,t,r,n).width,Ht=(e,t,r=0,n)=>{if(t==null||t.length===0)return xr;const s=e.measureText(t);return{width:n?On(s.width,n)+r:s.width+r,height:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent+r+r}},Is=(e,t,r=0)=>Ht(e,t,r).height,Lr=(e,t,r)=>{$(e,r);const n=r.anchorPadding??0,s=r.align??"top",i=r.anchor,a=r.bounds??{x:0,y:0,width:1e6,height:1e6},l=t.map(f=>e.measureText(f)),o=l.map(f=>f.width),c=l.map(f=>f.actualBoundingBoxAscent+f.actualBoundingBoxDescent+3),h=Math.max(...o),u=c.reduce((f,y)=>f+y,0);let{x:p,y:b}=i;i.x+h>a.width?p=a.width-(h+n):p-=n,p<a.x&&(p=a.x+n),i.y+u>a.height?b=a.height-(u+n):b-=n,b<a.y&&(b=a.y+n),s==="top"?e.textBaseline="top":e.textBaseline="middle";for(const[f,y]of t.entries())e.fillText(y,p,b),b+=c[f]},Ms=(e,t,r)=>{const{bounds:n}=r,{horiz:s="left",vert:i="top"}=r,a=typeof t=="string"?[t]:t;$(e,r),e.save(),e.translate(n.x,n.y),e.textAlign="left",e.textBaseline="top";const l=n.width/2,o=n.height/2,c=a.map(b=>e.measureText(b)),h=c.map(b=>b.actualBoundingBoxAscent+b.actualBoundingBoxDescent),u=h.reduce((b,f)=>b+f,0);let p=0;i==="center"?p=o-u/2:i==="bottom"&&(p=n.height-u);for(const[b,f]of a.entries()){let y=0;s==="center"?y=l-c[b].width/2:s==="right"&&(y=n.width-c[b].width),e.fillText(f,y,p),p+=h[b]}e.restore()};var Wr=Object.defineProperty,Ls=(e,t,r)=>t in e?Wr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ws=(e,t)=>{for(var r in t)Wr(e,r,{get:t[r],enumerable:!0})},oe=(e,t,r)=>Ls(e,typeof t!="symbol"?t+"":t,r);function d(e,t){if(e)return;if(t===void 0)throw new Error("invariant requires an error message argument");const r=t?new Error(t):new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");throw r.name="colorizr",r}var H={hsl:["h","s","l"],oklab:["l","a","b"],oklch:["l","c","h"],rgb:["r","g","b"]},Bs=["hsl","oklab","oklch","rgb"],gr=Math.PI/180,me={l:[.3963377773761749,.2158037573099136],m:[-.1055613458156586,-.0638541728258133],s:[-.0894841775298119,-1.2914855480194092]},q={l:[.4122214708,.5363325363,.0514459929],m:[.2119034982,.6806995451,.1073969566],s:[.0883024619,.2817188376,.6299787005]},G={l:[.2104542553,.793617785,.0040720468],a:[1.9779984951,2.428592205,.4505937099],b:[.0259040371,.7827717662,.808675766]},Y={r:[4.076741636075958,-3.307711539258063,.2309699031821043],g:[-1.2684379732850315,2.609757349287688,-.341319376002657],b:[-.0041960761386756,-.7034186179359362,1.7076146940746117]},Z=5,zs=180/Math.PI,g={alpha:"amount must be a number between 0 and 1",input:"input is required",inputHex:"input is required and must be a hex",inputNumber:"input is required and must be a number",inputString:"input is required and must be a string",invalid:"invalid input",invalidCSS:"invalid CSS string",left:"left is required and must be a string",right:"right is required and must be a string",threshold:"threshold must be a number between 0 and 255"},dt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Fs(e){return Array.isArray(e)&&e.length===6}function ue(e){return x(e)&&Object.keys(dt).includes(e.toLowerCase())}function W(e){return typeof e=="number"&&!Number.isNaN(e)}function $e(e){if(!e)return!1;const{toString:t}=Object.prototype,r=Object.getPrototypeOf(e);return t.call(e)==="[object Object]"&&(r===null||r===Object.getPrototypeOf({}))}function x(e,t=!0){const r=typeof e=="string";return t?r&&!!e.trim().length:r}function Br(e){return gt(e)||wt(e)||bt(e)||yt(e)}function k(e){return x(e)?/^#([\da-f]{3,4}|[\da-f]{6,8})$/i.test(e):!1}function gt(e){if(!$e(e))return!1;const t=Object.entries(e);return!!t.length&&t.every(([r,n])=>r==="h"?n>=0&&n<=360:r==="alpha"?n>=0&&n<=1:H.hsl.includes(r)&&n>=0&&n<=100)}function bt(e){if(!$e(e))return!1;const t=Object.entries(e);return!!t.length&&t.every(([r,n])=>r==="l"?n>=0&&n<=100:r==="alpha"?n>=0&&n<=1:H.oklab.includes(r)&&n>=-1&&n<=1)}function yt(e){if(!$e(e))return!1;const t=Object.entries(e);return!!t.length&&t.every(([r,n])=>r==="l"?n>=0&&n<=100:r==="alpha"?n>=0&&n<=1:H.oklch.includes(r)&&n>=0&&n<=(r==="h"?360:1))}function wt(e){if(!$e(e))return!1;const t=Object.entries(e);return!!t.length&&t.every(([r,n])=>r==="alpha"?n>=0&&n<=1:H.rgb.includes(r)&&n>=0&&n<=255)}function v(e,t){d(Br(e),g.invalid);let r=t;return!r||(r>1&&(r/=100),r===1)?e:{...e,alpha:r}}function Q(e,t=0,r=100){return Math.min(Math.max(e,t),r)}function Hs(e,t){d(W(e),g.inputNumber);let r=e+t;return r>360&&(r%=360),r<0&&(r+=360),Math.abs(r)}function U(e,t,r){switch(d(W(e),"Input is not a number"),d(Bs.includes(t),`Invalid model${t?`: ${t}`:""}`),d(H[t].includes(r),`Invalid key${r?`: ${r}`:""}`),t){case"hsl":return d(H.hsl.includes(r),"Invalid key"),["s","l"].includes(r)?Q(e):Q(e,0,360);case"rgb":return d(H.rgb.includes(r),"Invalid key"),Q(e,0,255);default:throw new Error("Invalid inputs")}}function C(e,t){const r=H[t],n={hsl:gt,oklab:bt,oklch:yt,rgb:wt};d($e(e)||Array.isArray(e),g.invalid);const s=Array.isArray(e)?{[r[0]]:e[0],[r[1]]:e[1],[r[2]]:e[2]}:e;return d(n[t](s),`invalid ${t} color`),s}function ke(e,t=Z,r=!0){const n=new Map(Object.entries(e));for(const[s,i]of n.entries())n.set(s,m(i,t,r));return Object.fromEntries(n)}function m(e,t=2,r=!0){if(!W(e)||e===0)return 0;if(r){const l=10**t;return Math.round(e*l)/l}const n=Math.abs(e);let s=Math.abs(Math.ceil(Math.log(n)/Math.LN10));s===0?s=2:s>t&&(s=t);let i=t-(s<0?0:s);i<=1&&t>1?i=2:(i>t||i===0)&&(i=t);const a=10**i;return Math.round(e*a)/a}function br(e,t){return d(k(e),g.inputHex),d(W(t),g.inputNumber),t>=1?it(e):`${it(e)}${st(t)}`}function st(e){d(W(e),g.inputNumber);let t=e;return e>1&&(t/=100),Math.round(t*255).toString(16).padStart(2,"0")}function Dt(e){d(k(e),g.inputString);const t=e.substring(7,9);return t?m(parseInt(t,16)/255):1}function it(e){return d(k(e),g.inputHex),e.length===5?e.substring(0,4):e.substring(0,7)}var le={};Ws(le,{hex2hsl:()=>_t,hex2oklab:()=>zr,hex2oklch:()=>Vt,hex2rgb:()=>ne,hsl2hex:()=>Fr,hsl2oklab:()=>Hr,hsl2oklch:()=>Dr,hsl2rgb:()=>Te,oklab2hex:()=>Gs,oklab2hsl:()=>_r,oklab2oklch:()=>jt,oklab2rgb:()=>Pe,oklch2hex:()=>Os,oklch2hsl:()=>jr,oklch2oklab:()=>qt,oklch2rgb:()=>je,rgb2hex:()=>pt,rgb2hsl:()=>Re,rgb2oklab:()=>De,rgb2oklch:()=>_e});function Ds(e){d(k(e),g.inputHex);let t=e.replace("#","");if(t.length===3||t.length===4){const n=[...t];t="",n.forEach(s=>{t+=`${s}${s}`})}const r=`#${t}`;return d(k(r),"invalid hex"),r}function ne(e){d(k(e),g.inputHex);const t=Ds(e).slice(1);return{r:parseInt(t.charAt(0)+t.charAt(1),16),g:parseInt(t.charAt(2)+t.charAt(3),16),b:parseInt(t.charAt(4)+t.charAt(5),16)}}function Re(e){const t=C(e,"rgb"),r=U(t.r,"rgb","r")/255,n=U(t.g,"rgb","g")/255,s=U(t.b,"rgb","b")/255,i=Math.min(r,n,s),a=Math.max(r,n,s),l=a-i;let o=0,c;const h=(a+i)/2;let u;switch(a){case r:u=l?(n-s)/l:0,o=60*u;break;case n:u=(s-r)/l,o=60*u+120;break;case s:u=(r-n)/l,o=60*u+240;break}return o<0&&(o=360+o),i===a?c=0:c=h<.5?l/(2*h):l/(2-2*h),{h:Math.abs(+(o%360).toFixed(2)),s:+(c*100).toFixed(2),l:+(h*100).toFixed(2)}}function _t(e){return d(k(e),g.inputHex),Re(ne(e))}var{cbrt:Tt,sign:_s}=Math;function Pt(e){const t=Math.abs(e);return t<.04045?e/12.92:(_s(e)||1)*((t+.055)/1.055)**2.4}function De(e,t=Z){const r=C(e,"rgb"),[n,s,i]=[Pt(r.r/255),Pt(r.g/255),Pt(r.b/255)],a=Tt(q.l[0]*n+q.l[1]*s+q.l[2]*i),l=Tt(q.m[0]*n+q.m[1]*s+q.m[2]*i),o=Tt(q.s[0]*n+q.s[1]*s+q.s[2]*i),c={l:G.l[0]*a+G.l[1]*l-G.l[2]*o,a:G.a[0]*a-G.a[1]*l+G.a[2]*o,b:G.b[0]*a+G.b[1]*l-G.b[2]*o};return ke(c,t)}function zr(e,t){return d(k(e),g.inputHex),De(ne(e),t)}var{atan2:js,sqrt:Vs}=Math;function jt(e,t){const{l:r,a:n,b:s}=ke(C(e,"oklab")),i=Vs(n**2+s**2);let a=(js(s,n)*zs+360)%360;return m(i*1e4)===0&&(a=0),ke({l:r,c:i,h:a},t)}function _e(e,t){const r=C(e,"rgb");return jt(De(r,t),t)}function Vt(e,t){return d(k(e),g.inputHex),_e(ne(e),t)}function Et(e,t,r){d(W(e)&&W(t)&&W(r),"point, chroma and h are required");let n=r;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?m(e+(t-e)*6*n,4):n<1/2?m(t,4):n<2/3?m(e+(t-e)*(2/3-n)*6,4):m(e,4)}function Te(e){const t=C(e,"hsl"),r=m(t.h)/360,n=m(t.s)/100,s=m(t.l)/100;let i,a,l,o,c;return n===0?(i=s,a=s,l=s):(c=s<.5?s*(1+n):s+n-s*n,o=2*s-c,i=Et(o,c,r+1/3),a=Et(o,c,r),l=Et(o,c,r-1/3)),{r:Math.round(i*255),g:Math.round(a*255),b:Math.round(l*255)}}function pt(e){const t=C(e,"rgb");return`#${Object.values(t).map(r=>`0${Math.floor(r).toString(16)}`.slice(-2)).join("")}`}function Fr(e){const t=C(e,"hsl");return pt(Te(t))}function Hr(e,t){const r=C(e,"hsl");return De(Te(r),t)}function Dr(e,t){const r=C(e,"hsl");return _e(Te(r),t)}var{abs:qs}=Math;function Nt(e){const t=qs(e),r=e<0?-1:1;return t>.0031308?r*(t**(1/2.4)*1.055-.055):e*12.92}function Pe(e,t=0){const{l:r,a:n,b:s}=C(e,"oklab"),i=(r+me.l[0]*n+me.l[1]*s)**3,a=(r+me.m[0]*n+me.m[1]*s)**3,l=(r+me.s[0]*n+me.s[1]*s)**3,o=255*Nt(Y.r[0]*i+Y.r[1]*a+Y.r[2]*l),c=255*Nt(Y.g[0]*i+Y.g[1]*a+Y.g[2]*l),h=255*Nt(Y.b[0]*i+Y.b[1]*a+Y.b[2]*l);return{r:Q(m(o,t),0,255),g:Q(m(c,t),0,255),b:Q(m(h,t),0,255)}}function Gs(e){const t=C(e,"oklab");return pt(Pe(t))}function _r(e){const t=C(e,"oklab");return Re(Pe(t))}var{sin:Ys,cos:Us}=Math;function qt(e,t){let{l:r,c:n,h:s}=C(e,"oklch");return(Number.isNaN(s)||s<0)&&(s=0),ke({l:r,a:n*Us(s*gr),b:n*Ys(s*gr)},t)}function je(e,t=0){const r=C(e,"oklch");return Pe(qt(r),t)}function Os(e){const t=C(e,"oklch");return pt(je(t))}function jr(e){const t=C(e,"oklch");return Re(je(t))}function R(e){if(d(x(e),g.inputString),k(e)){const a=H.rgb,{r:l,g:o,b:c}=ne(e),h=Dt(e);return{model:"rgb",[a[0]]:l,[a[1]]:o,[a[2]]:c,alpha:h<1?h:void 0}}const r=/(?:(rgb|hsl|oklab|oklch)a?\s*\(\s*([\d%.-]+)\s*[ ,/]\s*([\d%.-]+)\s*[ ,/]\s*([\d%.-]+)(?:\s*[ ,/]\s*([\d%.-]+))?\s*\))/i.exec(e);d(Fs(r),g.invalidCSS);const n=r[1],s=H[n];let i=r[5]?parseFloat(r[5]):1;return i>1&&(i/=100),{model:n,[s[0]]:parseFloat(r[2]),[s[1]]:parseFloat(r[3]),[s[2]]:parseFloat(r[4]),alpha:i<1?i:void 0}}function S(e,t){d(x(e),g.inputString);let r;const n=ue(e)?dt[e.toLowerCase()]:e,s=t??(k(n)?"hex":R(n).model),i=a=>Object.values(a);if(k(n)){const a=Dt(n);switch(s){case"hsl":{r=v(_t(n),a);break}case"oklab":{r=v(zr(n),a);break}case"oklch":{r=v(Vt(n),a);break}case"rgb":{r=v(ne(n),a);break}default:{r=`${it(n)}${a!==1?st(a):""}`;break}}return r}switch(s){case"hsl":{const{alpha:a,model:l,...o}=R(n);["oklab","oklch"].includes(l)&&o.l>1&&(o.l=m(o.l/100,Z)),r=v(l==="hsl"?o:le[`${l}2hsl`](i(o)),a);break}case"oklab":{const{alpha:a,model:l,...o}=R(n);["oklab","oklch"].includes(l)&&o.l>1&&(o.l=m(o.l/100,Z)),r=v(l==="oklab"?o:le[`${l}2oklab`](i(o)),a);break}case"oklch":{const{alpha:a,model:l,...o}=R(n);["oklab","oklch"].includes(l)&&o.l>1&&(o.l=m(o.l/100,Z)),r=v(l==="oklch"?o:le[`${l}2oklch`](i(o)),a);break}case"rgb":{const{alpha:a,model:l,...o}=R(n);["oklab","oklch"].includes(l)&&o.l>1&&(o.l/=100),r=v(l==="rgb"?o:le[`${l}2rgb`](i(o)),a);break}case"hex":default:{const{alpha:a,model:l,...o}=R(n);let c="";["oklab","oklch"].includes(l)&&o.l>1&&(o.l=m(o.l/100,Z)),a&&(c=st(a)),r=`${le[`${l}2hex`](i(o))}${c}`;break}}return r}function Ks(e){d(!!e,g.input);const t={};if(x(e)){const{alpha:r=1}=R(e),n=k(e)?"hex":R(e).model;t.hex=br(S(e,"hex"),r),t.hsl=v(S(e,"hsl"),r),t.oklab=v(S(e,"oklab"),r),t.oklch=v(S(e,"oklch"),r),t.rgb=v(S(e,"rgb"),r),t.alpha=r,t.type=n}else if($e(e)){const{alpha:r=1}=e;if(gt(e))t.hsl={h:U(e.h,"hsl","h"),s:U(e.s,"hsl","s"),l:U(e.l,"hsl","l")},t.rgb=Te(t.hsl),t.oklab=Hr(t.hsl),t.oklch=Dr(t.hsl),t.type="hsl";else if(bt(e))t.hsl=_r(e),t.oklab=e,t.oklch=jt(e),t.rgb=Pe(e),t.type="oklab";else if(yt(e))t.hsl=jr(e),t.oklab=qt(e),t.oklch=e,t.rgb=je(e),t.type="oklch";else if(wt(e))t.rgb={r:U(e.r,"rgb","r"),g:U(e.g,"rgb","g"),b:U(e.b,"rgb","b")},t.hsl=Re(t.rgb),t.oklab=De(t.rgb),t.oklch=_e(t.rgb),t.type="rgb";else throw new Error("invalid color");t.hex=br(Fr(t.hsl),r),t.hsl=v(t.hsl,r),t.oklab=v(t.oklab,r),t.oklch=v(t.oklch,r),t.rgb=v(t.rgb,r),t.alpha=r}else throw new Error(g.input);return t}function Vr(e,t,r=Z){d(x(e),g.left),d(x(t),g.right);const n=S(e,"rgb"),s=S(t,"rgb"),i=(n.r*299+n.g*587+n.b*114)/1e3,a=(s.r*299+s.g*587+s.b*114)/1e3;return m(Math.abs(a-i),r)}function Xs(e){d(x(e),g.inputString);const{r:t,g:r,b:n}=S(e,"rgb"),s=Math.max(t,r,n),i=Math.min(t,r,n);return m((s-i)/255,4)}function qr(e,t){d(x(e),g.left),d(x(t),g.right);const r=S(e,"rgb"),n=S(t,"rgb");return Math.max(r.r,n.r)-Math.min(r.r,n.r)+(Math.max(r.g,n.g)-Math.min(r.g,n.g))+(Math.max(r.b,n.b)-Math.min(r.b,n.b))}function It(e){d(x(e),g.inputString);const{r:t,g:r,b:n}=S(e,"rgb"),s=[t/255,r/255,n/255];for(let i=0;i<s.length;i++)s[i]<=.03928?s[i]/=12.92:s[i]=((s[i]+.055)/1.055)**2.4;return m(.2126*s[0]+.7152*s[1]+.0722*s[2],4)}function Gr(e,t){d(x(e),g.left),d(x(t),g.right);const r=It(e),n=It(t);return m(r>=n?(r+.05)/(n+.05):(n+.05)/(r+.05))}function Js(e,t){d(x(e),g.left),d(x(t),g.right);const r=500,n=125,s=qr(e,t),i=Gr(e,t),a=Vr(e,t),l=a>=n,o=s>=r;let c=0;return l&&o?c=2:(l||o)&&(c=1),{brightnessDifference:a,colorDifference:s,compliant:c,contrast:i,largeAA:i>=3,largeAAA:i>=4.5,normalAA:i>=4.5,normalAAA:i>=7}}function Zs(e){if(k(e)||ue(e))return"hex";if(x(e))return R(e).model;if(gt(e))return"hsl";if(bt(e))return"oklab";if(yt(e))return"oklch";if(wt(e))return"rgb";throw new Error(g.invalid)}function Le(e,t){const r=ue(e)?dt[e.toLowerCase()]:e,n=Zs(r);if(n===t)return r;const s=`${n}2${t}`,i=le[s];if(!i)throw new Error(`Converter not found for ${n} to ${t}`);switch(n){case"hex":return t==="hex"?r:i(r);case"hsl":return t==="hsl"?r:i(r);case"oklab":return t==="oklab"?r:i(r);case"oklch":return t==="oklch"?r:i(r);default:return t==="rgb"?r:i(r)}}function te(e,t={}){d(k(e)||Br(e),g.invalid);const{alpha:r,format:n="hex",precision:s=Z,separator:i=" "}=t,a=r&&r!==1?`${m(r*100)}%`:null;let l=[],o=i;switch(n){case"hsl":{const{h:c,s:h,l:u}=Le(e,"hsl");l=[c,`${h}%`,`${u}%`];break}case"oklab":{o=" ";const{l:c,a:h,b:u}=ke(Le(e,"oklab"),s);l=[`${m(c*100,s)}%`,h,u];break}case"oklch":{o=" ";const{l:c,c:h,h:u}=ke(Le(e,"oklch"),s);l=[`${m(c*100,s)}%`,h,u];break}case"rgb":{const{r:c,g:h,b:u}=Le(e,"rgb");l=[c,h,u];break}default:{const c=it(Le(e,"hex"));return r&&r!==1?`${c}${st(r)}`:c}}return`${n}(${l.join(o)}${a?` / ${a}`:""})`}function mt(e,t,r){return(n,s)=>{d(x(n),g.inputString),d(W(s),g.alpha);const i=S(n,"hsl"),a=k(n)||ue(n)?"hex":R(n).model;return te({...i,[e]:Q(i[e]+(t==="+"?s:-s),0,100)},{format:a})}}function Qs(e,t,r){return mt("l","-")(e,t)}function ei(e,t,r){return mt("s","-")(e,t)}function Yr(e,t,r){d(x(e),g.inputString),d(W(t),"degrees must be a number");const n=S(e,"hsl"),s=k(e)||ue(e)?"hex":R(e).model;return te({...n,h:Hs(n.h,t)},{format:s})}function ti(e){d(x(e),g.inputString);const t=k(e)||ue(e)?"hex":R(e).model,r=S(e,"hex");return te(Yr(r,180),{format:t})}function ri(e,t,r){return mt("l","+")(e,t)}function ni(e,t,r){d(x(e),g.inputString),d(W(t),g.alpha);const n=k(e)||ue(e)?"hex":R(e).model,s=S(e,"rgb");return te(s,{format:r??n,alpha:t})}function Ur(e){if(d(x(e),g.inputString),k(e))return Dt(e);if(Object.keys(dt).includes(e))return 1;const{alpha:t}=R(e);return t||1}function si(e,t,r){return mt("s","+")(e,t)}function ii(e,t={}){const{darkColor:r="#000000",lightColor:n="#ffffff",threshold:s=128}=t;d(x(e),g.inputString),d(s>=0&&s<=255,g.threshold);try{const{r:i,g:a,b:l}=ne(S(e,"hex"));return(i*299+a*587+l*114)/1e3>=s?r:n}catch(i){return console.warn(`Invalid color input: ${e}`),console.warn(i),r}}function ai(e,t,r){d(x(e),g.inputString),d(W(t),g.alpha),d(t>=-1&&t<=1,g.alpha);const n=S(e,"oklab"),s=m(Q(Ur(e)-t,0,1));return te(n,{format:r,alpha:s})}var oi=class{constructor(e,t={}){oe(this,"alpha"),oe(this,"hex"),oe(this,"hsl"),oe(this,"oklab"),oe(this,"oklch"),oe(this,"rgb"),oe(this,"type"),d(!!e,"color is required");const{alpha:r,hex:n,hsl:s,oklab:i,oklch:a,rgb:l,type:o}=Ks(e);this.hex=n,this.hsl=s,this.oklab=i,this.oklch=a,this.rgb=l,this.alpha=r,this.type=t.format??o}get css(){return this.selectedColor}get red(){return Number(this.rgb.r)}get green(){return Number(this.rgb.g)}get blue(){return Number(this.rgb.b)}get hue(){return Number(this.hsl.h)}get saturation(){return Number(this.hsl.s)}get lightness(){return Number(this.hsl.l)}get luminance(){return It(this.selectedColor)}get chroma(){return Xs(this.selectedColor)}get opacity(){return Ur(this.selectedColor)}get textColor(){return ii(this.selectedColor)}get selectedColor(){return te(this[this.type],{format:this.type,alpha:this.alpha})}brightnessDifference(e){return Vr(this.selectedColor,e)}colorDifference(e){return qr(this.selectedColor,e)}compare(e){return Js(this.selectedColor,e)}contrast(e){return Gr(this.selectedColor,e)}format(e,t){return te(this.rgb,{alpha:this.alpha,format:e,precision:t})}lighten(e){return ri(this.selectedColor,e)}darken(e){return Qs(this.selectedColor,e)}saturate(e){return si(this.selectedColor,e)}desaturate(e){return ei(this.selectedColor,e)}invert(){return ti(this.selectedColor)}opacify(e=.9){return ni(this.selectedColor,e,this.type)}rotate(e){return Yr(this.selectedColor,e)}transparentize(e=.1){return ai(this.selectedColor,e,this.type)}};function Gt(e,t){const r=S(e,t);return te(r,{format:t})}var xt=oi;const re=e=>!(typeof e!="object"||!("h"in e)||!("s"in e)||!("l"in e)||!("unit"in e)||!("space"in e)||e.space!=="hsl"),O=e=>typeof e!="object"||!("r"in e)||!("g"in e)||!("b"in e)||!("space"in e)||!("unit"in e)?!1:e.space==="srgb",Yt=e=>{if(typeof e!="object")throw new TypeError(`Param 'v' is expected to be an object, got: ${typeof e}`);if("r"in e&&"g"in e&&"b"in e){if(!("unit"in e))if(e.r<=1&&e.g<=1&&e.b<=1)e.unit="scalar";else{if(e.r>255&&e.g<=255&&e.b<=255)return;e.unit="8bit"}return"space"in e||(e.space="srgb"),e}},Ut=e=>{if("h"in e&&"s"in e&&"l"in e){if(!("unit"in e))if(e.r<=1&&e.g<=1&&e.b<=1)e.unit="scalar";else{if(e.s>100&&e.l<=100)return;e.unit="absolute"}return"space"in e||(e.space="hsl"),e}},Se=e=>typeof e!="object"||!("l"in e)||!("c"in e)||!("h"in e)||!("unit"in e)||!("space"in e)?!1:e.space==="lch"||e.space==="oklch",Or=e=>typeof e=="string"?!0:typeof e!="object"?!1:!!(re(e)||Se(e)||O(e));function Kr(e,t,r=1){let n=-1,s=-1;t<e?(n=t-e,s=r-(e-t)):(n=t-e,s=n-r);const i=s>0?s:n,a=s>0?n:s;if(Math.abs(n)<Math.abs(s)){const l=s;s=n,n=l}return{long:n,short:s,forward:i,backward:a}}const Ot=e=>{const t=n=>{const s=Math.floor(n).toString(16);return s.length==1?"0"+s:s};let r=`#${t(e.r)}${t(e.g)}${t(e.b)}`;return typeof e.alpha<"u"&&e.alpha!==255&&(r+=t(e.alpha)),r};function Xr(e){return e=e%1,e<0?(1-Math.abs(e))%1:e}var Jr={};P(Jr,{absolute:()=>Be,changeLightness:()=>li,fromCss:()=>Ve,fromHexString:()=>Mt,generateScalar:()=>fi,guard:()=>Ne,interpolator:()=>Kt,parseCssHslFunction:()=>Qr,scalar:()=>fe,toAbsolute:()=>Ee,toCssString:()=>at,toHexString:()=>Lt,toLibraryRgb:()=>Ie,toScalar:()=>ve,withOpacity:()=>Zr});const Zr=(e,t)=>{switch(e.unit){case"absolute":return{...e,opacity:t((e.opacity??100)/100,e)*100};case"scalar":return{...e,opacity:t(e.opacity??1,e)}}},li=(e,t)=>{let r=0;if(typeof t.pdelta<"u")r=e.l+e.l*t.pdelta;else if(typeof t.delta<"u")r=t.delta+e.l;else if(typeof t.fixed<"u"){if(t.fixed<0)throw new TypeError("Cannot use negative value with 'fixed'");r=t.fixed}else throw new TypeError("Parameter 'amount' is missing 'delta/pdelta/fixed' properties");return{...e,l:ci(e,r)}},ci=(e,t,r)=>(e.unit==="scalar"?t>1?t=1:t<0&&(t=0):t>100?t=100:t<0&&(t=0),t),hi=Object.freeze({h:0,s:0,l:0,opacity:0,unit:"absolute",space:"hsl"});function Mt(e,t={}){return kt(_t(e),t)}function Ve(e,t={}){if(e=e.toLowerCase(),e.startsWith("hsla("))throw new Error("hsla() not supported");if(e.startsWith("rgba("))throw new Error("rgba() not supported");if(e.startsWith("#"))return Mt(e,t);if(e.startsWith("--"))try{e=Qt(e)}catch(r){if(typeof t.fallbackString<"u"&&(e=t.fallbackString),typeof t.fallbackColour<"u")return t.fallbackColour;throw r}if(e==="transparent")return hi;if(typeof z[e]<"u")return Mt(z[e],t);if(e.startsWith("rgb(")){const r=Ye(e);return kt(r,t)}if(!e.startsWith("hsl("))try{e=Gt(e,"hsl")}catch(r){if(t.fallbackString)e=t.fallbackString;else throw r}try{const r=Qr(e);return t.scalar?ve(r):Ee(r)}catch(r){if(t.fallbackColour)return t.fallbackColour;throw r}}const at=e=>{const t=Ee(e);let r=`hsl(${t.h}deg ${t.s}% ${t.l}%`;return"opacity"in t&&t.opacity!==void 0&&t.opacity<100&&(r+=` / ${t.opacity}%`),r+=")",r},Lt=e=>{const t=Ie(e);return Ot(t)};function kt(e,t={}){if((typeof e>"u"||e===null)&&t.fallbackColour)return t.fallbackColour;const r=t.scalar??!0;return D(I(e.h,0,360,"h"),I(e.s,0,100,"s"),I(e.l,0,100,"l"),F(e.alpha??1,"alpha")),r?fe(e.h/360,e.s/100,e.l/100,e.alpha??1):Be(e.h,e.s,e.l,(e.alpha??1)*100)}const Ee=e=>{if(typeof e=="string")return Ve(e,{scalar:!1});if(O(e))return Ee(kt(Ye(e),{scalar:!1}));const t=e;return Ne(t),t.unit==="absolute"?t:{h:t.h*360,s:t.s*100,l:t.l*100,opacity:(t.opacity??1)*100,unit:"absolute",space:"hsl"}},fi=(e,t=1,r=.5,n=1)=>{typeof e=="string"&&e.startsWith("--")&&(e=getComputedStyle(document.body).getPropertyValue(e).trim());const s=kr(e);if(t>1)throw new TypeError("Param 'saturation' must be between 0..1");if(r>1)throw new TypeError("Param 'lightness' must be between 0..1");if(n>1)throw new TypeError("Param 'opacity' must be between 0..1");return{h:Sr(s,"deg").value/360,s:t,l:r,opacity:n,unit:"scalar",space:"hsl"}},ve=e=>{if(typeof e=="string")return Ve(e,{scalar:!0});if(O(e))return ve(kt(Ye(e),{scalar:!0}));const t=e;return Ne(t),t.unit==="scalar"?t:{h:t.h/360,s:t.s/100,l:t.l/100,opacity:(t.opacity??1)/100,unit:"scalar",space:"hsl"}},Ne=e=>{const{h:t,s:r,l:n,opacity:s,space:i,unit:a}=e;if(i!=="hsl")throw new Error(`Space is expected to be 'hsl'. Got: ${i}`);if(a==="absolute")D(N(t,"finite","h"),I(r,0,100,"s"),I(n,0,100,"l"),()=>{if(typeof s=="number")return I(s,0,100,"opacity")});else if(a==="scalar")D(N(t,"percentage","h"),N(r,"percentage","s"),N(n,"percentage","l"),()=>{if(typeof s=="number")return N(s,"percentage","opacity")});else throw new Error(`Unit is expected to be 'absolute' or 'scalar'. Got: ${a}`)},Kt=(e,t,r="shorter")=>{e=ve(e),t=ve(t);const n=e.opacity??1,s=Kr(e.h,t.h,1),i=r==="longer"?s.long:s.short,a=t.s-e.s,l=t.l-e.l,o=(t.opacity??1)-n;return c=>{c=ee(c);let h=L(c,0,Math.abs(i));i<0?h=e.h-h:h=e.h+h;const u=L(c,0,a),p=L(c,0,l),b=L(c,0,o);return fe(Xr(h),u+e.s,p+e.l,b+n)}};function fe(e=.5,t=1,r=.5,n=1){const s={unit:"scalar",space:"hsl",h:e,s:t,l:r,opacity:n};return Ne(s),s}function Be(e=200,t=100,r=50,n=100){const s={unit:"absolute",space:"hsl",h:e,s:t,l:r,opacity:n};return Ne(s),s}function Qr(e){if(e.startsWith("hsla"))throw new Error("hsla() is not supported");if(!e.startsWith("hsl("))throw new Error("Expected hsl(..) CSS colour");const t=e.indexOf("("),r=e.indexOf(")");if(r<t)throw new Error("Is hsl() not terminated? Missing ')'");let s=e.substring(t+1,r).split(/[\s,]+/);if(s.length<3)throw new Error(`Expected three tokens. Got: ${s.length} length`);let i=!1;s[0].endsWith("%")&&(i=!0),s[1].endsWith("%")&&s[2].endsWith("%")&&(i=!0);const a=(o,c)=>{if(o==="none")return 0;if(o.endsWith("%"))return Number.parseFloat(o.substring(0,o.length-1))/100;o.endsWith("deg")&&c===0&&(o=o.substring(0,o.length-3));const h=Number.parseFloat(o);return c===0?h/360:c===3?h:h/100},l=(o,c)=>{if(o==="none")return 0;if(o.endsWith("%")){const u=Number.parseFloat(o.substring(0,o.length-1));return c===0?u*360:u}return o.endsWith("deg")&&c===0?Number.parseFloat(o.substring(0,o.length-3)):Number.parseFloat(o)};return s.length>3&&s[3]==="/"&&(s=[s[0],s[1],s[2],s[4]]),i?fe(a(s[0],0),a(s[1],1),a(s[2],2),a(s[3]??"100%",3)):Be(l(s[0],0),l(s[1],1),l(s[2],2),l(s[3]??"100%",3))}function Ie(e){if(typeof e=="string"){const r=Ve(e,{scalar:!1});return Ie(r)}return e=Ee(e),{...Te({h:e.h,s:e.s,l:e.l}),alpha:(e.opacity??100)/100*255}}var en={};P(en,{OKLCH_CHROMA_MAX:()=>Me,absolute:()=>sn,fromCss:()=>St,fromHexString:()=>Wt,fromLibrary:()=>ot,generateScalar:()=>gi,guard:()=>de,interpolator:()=>Xt,scalar:()=>Jt,toAbsolute:()=>vt,toCssString:()=>tn,toHexString:()=>rn,toScalar:()=>ze,withOpacity:()=>nn});const Me=.4,de=e=>{const{l:t,c:r,h:n,opacity:s,space:i,unit:a}=e;if(i!=="oklch")throw new Error(`Space is expected to be 'oklch'. Got: ${i}`);if(a==="absolute")D(F(t,"l"),()=>{if(typeof r=="number")return I(r,0,Me,"c")},()=>{if(typeof n=="number")return I(r,0,360,"h")},F(s??1,"opacity"));else if(a==="scalar")D(F(t,"l"),F(r,"c"),F(n,"h"),F(e.opacity??1,"opacity"));else throw new Error(`Unit is expected to be 'absolute' or 'scalar'. Got: ${a}`)};function ot(e,t={}){if((typeof e>"u"||e===null)&&t.fallbackColour)return t.fallbackColour;const r=t.scalar??!0;return D(F(e.l,"l"),F(e.c,"c"),I(e.h,0,360,"h"),F(e.alpha??1,"alpha")),r?Jt(e.l,e.c/Me,e.h/360,e.alpha??1):sn(e.l,e.c,e.h,e.alpha??1)}const Wt=(e,t={})=>ot(Vt(e),t),ui=Object.freeze({l:0,c:0,h:0,opacity:0,unit:"absolute",space:"oklch"});function St(e,t={}){if(e=e.toLowerCase(),e.startsWith("#"))return Wt(e,t);if(e==="transparent")return ui;if(typeof z[e]<"u")return Wt(z[e],t);if(e.startsWith("rgb(")){const s=se(tr(e)),i=_e({r:s.r,g:s.g,b:s.b});return ot(i,t)}if(!e.startsWith("hsl(")&&!e.startsWith("oklch("))try{e=Gt(e,"oklch")}catch(s){if(t.fallbackString)e=t.fallbackString;else throw s}const n=new xt(e).oklch;return ot(n,t)}const vt=e=>typeof e=="string"?vt(St(e,{scalar:!0})):(de(e),e.unit==="absolute"?e:{space:"oklch",unit:"absolute",l:e.l,c:e.c*Me,h:e.h*360,opacity:e.opacity}),ze=e=>{if(typeof e=="string")return ze(St(e,{scalar:!0}));const t=e;return de(t),t.unit==="scalar"?t:{l:t.l,c:t.c/Me,h:t.h/360,opacity:t.opacity??1,unit:"scalar",space:"oklch"}},di=e=>{const t=vt(e);return{l:t.l,c:t.c,h:t.h,alpha:t.opacity}},tn=(e,t=3)=>{de(e);const{l:r,c:n,h:s,opacity:i}=e;let a="";switch(e.unit){case"absolute":a=`oklch(${(r*100).toFixed(t)}% ${n.toFixed(t)} ${s.toFixed(t)}`;break;case"scalar":a=`oklch(${r.toFixed(t)} ${(n*Me).toFixed(t)} ${(s*360).toFixed(t)}`;break}return typeof i<"u"&&i!==1&&(a+=` / ${i.toFixed(t)}`),a+=")",a},rn=e=>{const t=di(e),r=je(t);return Ot(r)},gi=(e,t=1,r=.5,n=1)=>{if(typeof e=="string"&&e.startsWith("--")&&(e=getComputedStyle(document.body).getPropertyValue(e).trim()),r>1)throw new TypeError("Param 'lightness' must be between 0..1");if(t>1)throw new TypeError("Param 'chroma' must be between 0..1");const s=kr(e),i=Sr(s,"deg").value/360;if(n>1)throw new TypeError("Param 'opacity' must be between 0..1");return{l:r,c:t,h:i,opacity:n,unit:"scalar",space:"oklch"}},nn=(e,t)=>{switch(e.unit){case"absolute":return{...e,opacity:t((e.opacity??100)/100,e)*100};case"scalar":return{...e,opacity:t(e.opacity??1,e)}}},Xt=(e,t,r="shorter")=>{e=ze(e),t=ze(t);const n=e.opacity??1,s=Kr(e.h,t.h,1),i=r==="longer"?s.long:s.short,a=t.c-e.c,l=t.l-e.l,o=(t.opacity??1)-n;return c=>{c=ee(c);let h=L(c,0,Math.abs(i));i<0?h=e.h-h:h=e.h+h;const u=L(c,0,a),p=L(c,0,l),b=L(c,0,o);return Jt(p+e.l,u+e.c,Xr(h),b+n)}};function Jt(e=.7,t=.1,r=.5,n=1){const s={unit:"scalar",space:"oklch",l:e,c:t,h:r,opacity:n};return de(s),s}const sn=(e,t,r,n=1)=>{const s={space:"oklch",unit:"absolute",opacity:n,l:e,c:t,h:r};return de(s),s},Zt=e=>{if(e.startsWith("#"))return Fe(e,!0);if(typeof z[e]<"u")return Fe(z[e],!0);if(e.startsWith("--")){const t=getComputedStyle(document.body).getPropertyValue(e).trim();if(t.length===0||t===null)throw new Error(`Variable missing: ${e}`);return Zt(t)}if(e=e.toLowerCase(),e.startsWith("hsl("))return Ve(e,{scalar:!0});if(e.startsWith("rgb("))return qe(e,{scalar:!0});if(e.startsWith("oklch("))return St(e,{scalar:!0});throw new Error(`String colour is not a hex colour, CSS variable nor well-defined colour. Input: '${e}'`)},Qt=(e,t)=>{if(e.startsWith("--")){const r=getComputedStyle(document.body).getPropertyValue(e).trim();if(r.length===0||r===null){if(typeof t<"u")return t;throw new Error(`CSS variable missing: '${e}'`)}return Qt(r)}return typeof z[e]<"u"?z[e]:e},z={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"#00000000"};var an={};P(an,{changeLightness:()=>wi,eightBit:()=>ln,fromCss:()=>qe,fromHexString:()=>Fe,guard:()=>ge,interpolator:()=>rr,lightness:()=>pi,parseCssRgbFunction:()=>tr,scalar:()=>er,to8bit:()=>se,toCssString:()=>He,toHexString:()=>Ze,toLibraryHsl:()=>Ye,toScalar:()=>Ce,withOpacity:()=>on});const on=(e,t)=>{switch(e.unit){case"8bit":return{...e,opacity:t((e.opacity??255)/255,e)*255};case"scalar":return{...e,opacity:t(e.opacity??1,e)}}};function Fe(e,t=!0){return Ge(ne(e),{scalar:t})}const bi=Object.freeze({r:0,g:0,b:0,opacity:0,unit:"8bit",space:"srgb"});function qe(e,t={}){if(e=e.toLowerCase(),e.startsWith("hsla("))throw new Error("hsla() not supported");if(e.startsWith("rgba("))throw new Error("rgba() not supported");const r=t.scalar??!0;if(e.startsWith("#"))return Fe(e,r);if(e==="transparent")return bi;if(typeof z[e]<"u"&&Fe(z[e],r),e.startsWith("hsl(")){const n=Ie(e);return Ge(n,t)}if(!e.startsWith("rgb("))try{e=Gt(e,"rgb")}catch(n){if(t.fallbackString)e=t.fallbackString;else throw n}try{const n=tr(e);return r?Ce(n):se(n)}catch(n){if(t.fallbackColour)return t.fallbackColour;throw n}}const Ze=e=>{const t=yi(e);return Ot(t)},He=e=>{switch(ge(e),e.unit){case"8bit":return e.opacity===void 0||e.opacity===255?`rgb(${e.r} ${e.g} ${e.b})`:`rgb(${e.r} ${e.g} ${e.b} / ${(e.opacity??255)/255})`;case"scalar":return e.opacity===void 0||e.opacity===1?`rgb(${e.r*100}% ${e.g*100}% ${e.b*100}%)`:`rgb(${e.r*100}% ${e.g*100}% ${e.b*100}% / ${(e.opacity??1)*100}%)`;default:throw new Error(`Unknown unit: ${e.unit}`)}},yi=e=>{const t=se(e);return{r:t.r,g:t.g,b:t.b,alpha:t.opacity}};function Ge(e,t={}){return t.scalar?{r:e.r/255,g:e.g/255,b:e.b/255,opacity:e.alpha??1,unit:"scalar",space:"srgb"}:{r:e.r,g:e.g,b:e.b,opacity:e.alpha??255,unit:"8bit",space:"srgb"}}const se=e=>typeof e=="string"?qe(e,{scalar:!1}):re(e)?se(Ge(Ie(e),{scalar:!1})):(ge(e),e.unit==="8bit"?e:{r:e.r*255,g:e.g*255,b:e.b*255,opacity:(e.opacity??1)*255,unit:"8bit",space:"srgb"}),Ce=e=>typeof e=="string"?qe(e,{scalar:!0}):re(e)?Ce(Ge(Ie(e),{scalar:!0})):(ge(e),e.unit==="scalar"?e:{r:e.r/255,g:e.g/255,b:e.b/255,opacity:(e.opacity??1)/255,unit:"scalar",space:"srgb"}),ge=e=>{const{r:t,g:r,b:n,opacity:s,space:i,unit:a}=e;if(i!=="srgb")throw new Error(`Space is expected to be 'srgb'. Got: ${i}`);if(a==="8bit")D(I(t,0,255,"r"),I(r,0,255,"g"),I(n,0,255,"b"),()=>{if(typeof s=="number")return I(s,0,255,"opacity")});else if(a==="scalar")D(N(t,"percentage","r"),N(r,"percentage","g"),N(n,"percentage","b"),()=>{if(typeof s=="number")return N(s,"percentage","opacity")});else throw new Error(`Unit is expected to be '8bit' or 'scalar'. Got: ${a}`)},wi=(e,t)=>{let r=0;const n=new xt(He(e)),s=e.unit==="scalar";if(typeof t.pdelta<"u")r=n.oklab.l+n.oklab.l*t.pdelta;else if(typeof t.delta<"u")r=n.oklab.l+t.delta;else if(typeof t.fixed<"u"){if(t.fixed<0)throw new TypeError("Amount cannot be negative when using 'fixed'");r=t.fixed}else throw new TypeError("Parameter 'amount' is missing 'pdelta/delta/fixed' properties");r<0?r=0:r>1&&(r=1);const i=Pe({a:n.oklab.a,b:n.oklab.b,l:r,alpha:n.oklab.alpha});return Ge(i,{scalar:s})};function pi(e){return new xt(He(e)).oklab.l}function ln(e=100,t=100,r=100,n=255){const s={unit:"8bit",space:"srgb",r:e,g:t,b:r,opacity:n};return ge(s),s}function er(e=.5,t=.5,r=.5,n=1){const s={unit:"scalar",space:"srgb",r:e,g:t,b:r,opacity:n};return ge(s),s}function tr(e){if(e.startsWith("rgba"))throw new Error("RGBA is not supported");if(!e.startsWith("rgb("))throw new Error("Expected rgb(..) CSS colour");const t=e.indexOf("("),r=e.indexOf(")");if(r<t)throw new Error("Is rgb() not terminated? Missing ')'");let s=e.substring(t+1,r).split(/[\s,]+/);if(s.length<3)throw new Error(`Expected three tokens. Got: ${s.length} length`);let i=0;for(const o of s)o.endsWith("%")&&i++;const a=(o,c)=>o.endsWith("%")?Number.parseFloat(o.substring(0,o.length-1))/100:c<3?Number.parseFloat(o)/255:Number.parseFloat(o),l=(o,c)=>o.endsWith("%")?Number.parseFloat(o.substring(0,o.length-1))/100*255:c<3?Number.parseFloat(o):Number.parseFloat(o)*255;return s.length>3&&s[3]==="/"&&(s=[s[0],s[1],s[2],s[4]]),i>1?er(a(s[0],0),a(s[1],1),a(s[2],2),a(s[3]??"1",3)):ln(l(s[0],0),l(s[1],1),l(s[2],2),l(s[3]??"1",3))}const rr=(e,t)=>{const r=Ce(e),n=Ce(t),s=r.opacity??1,i=(n.opacity??1)-s,a=n.r-r.r,l=n.g-r.g,o=n.b-r.b;return c=>(c=ee(c),er(r.r+L(c,0,a),r.g+L(c,0,l),r.b+L(c,0,o),s+L(c,0,i)))};function Ye(e){if(typeof e=="string"){const r=qe(e,{scalar:!1});return Ye(r)}return e=se(e),{...Re({r:e.r,g:e.g,b:e.b}),alpha:(e.opacity??255)/255}}var cn={};P(cn,{accessor:()=>Ue,byColumn:()=>xi,byRow:()=>mi,grid:()=>be,setter:()=>nr,wrap:()=>hn});const be=e=>({rows:e.width,cols:e.height}),hn=e=>({...be(e),get:Ue(e),set:nr(e)}),Ue=e=>{const t=be(e),r=e.data;return(s,i="undefined")=>{const a=vr(t,s,i);if(a===void 0)return;const l=a*4;return{r:r[l],g:r[l+1],b:r[l+2],opacity:r[l+3],unit:"8bit",space:"srgb"}}},nr=e=>{const t=be(e),r=e.data;return(s,i,a="undefined")=>{const l=vr(t,i,a);if(l===void 0)throw new Error(`Cell out of range. ${i.x},${i.y}`);const o=se(s),c=l*4;r[c]=o.r,r[c+1]=o.g,r[c+2]=o.b,r[c+3]=o.opacity??255}};function*mi(e){const t=Ue(e),r=be(e),n=ts(r,{x:0,y:0});for(const s of n)yield s.map(a=>t(a,"undefined"))}function*xi(e){const t=Ue(e),r=be(e);for(let n=0;n<r.cols;n++){const s=[];for(let i=0;i<r.rows;i++){const a=t({x:n,y:i},"undefined");a&&s.push(a)}yield s}}var ki=class extends ws{el;opts;#t;#e;#n=Cr;#r=xr;#s;#i;#a;#c=!1;constructor(e,t={}){if(super(),!e)throw new Error("Param 'domQueryOrEl' is null or undefined. Expected canvas element.");if(this.el=he(e),this.el.nodeName!=="CANVAS")throw new Error(`Expected CANVAS HTML element. Got: ${this.el.nodeName}`);const r=this.el.getBoundingClientRect();this.opts={resizeLogic:t.resizeLogic??"none",disablePointerEvents:t.disablePointerEvents??!1,pixelZoom:t.pixelZoom??(window.devicePixelRatio||1),height:t.height??r.height,width:t.width??r.width,zIndex:t.zIndex??-1,coordinateScale:t.coordinateScale??"both",onResizing:t.onResizing,onResized:t.onResized,clearOnResize:t.clearOnResize??!0,draw:t.draw,skipCss:t.skipCss??!1,colourSpace:"srgb"},this.#t=Je("both"),this.#e=Je("both",r),this.#f()}getRectangle(){return{x:0,y:0,...this.#r}}dispose(e){this.#c||(this.#c=!0,this.#a&&(this.#a.dispose(`CanvasHelper disposing ${e}`.trim()),this.#a=void 0))}#o(e=!1){if(this.#s===void 0||e){const t=this.ratio,r=this.el.getContext("2d");if(r===null)throw new Error("Could not create drawing context");this.#s=r,r.setTransform(1,0,0,1,0,0),r.scale(t,t)}return this.#s}getPhysicalSize(){return{width:this.width*this.ratio,height:this.height*this.ratio}}getDrawHelper(){this.#i||(this.#i=Pr(this.#o(),{width:this.width,height:this.height}))}setLogicalSize(e){ps(e,"logicalSize");const t=ms(s=>Math.floor(s),e),r=this.opts.pixelZoom;this.#t=Je(this.opts.coordinateScale,e),this.#e=Je("both",e);const n=xs(e,r);this.el.width=n.width,this.el.height=n.height,this.el.style.width=t.width.toString()+"px",this.el.style.height=t.height.toString()+"px",this.#o(!0),this.opts.clearOnResize&&this.ctx.clearRect(0,0,this.width,this.height),this.#r=t,this.opts.onResizing&&this.opts.onResizing(this.ctx,this.size,this),this.fireEvent("resize",{ctx:this.ctx,size:this.#r,helper:this})}#f(){const e=this.opts.draw;if(e){const r=()=>{e(this.ctx,this.#r,this),requestAnimationFrame(r)};setTimeout(()=>{r()},100)}if(this.opts.disablePointerEvents||this.#h(),(this.opts.resizeLogic??"none")==="none")this.setLogicalSize({width:this.opts.width,height:this.opts.height});else{const r={onSizeChanging:n=>{ks(this.#r,n)||this.setLogicalSize(n)},onSizeDone:(n,s)=>{this.#l(n)},containerEl:this.opts.containerEl,naturalSize:{width:this.opts.width,height:this.opts.height},stretch:this.opts.resizeLogic??"none"};this.#a=new tt(this.el,r)}this.#o()}#l(e){this.opts.onResized&&this.opts.onResized(this.ctx,this.size,this),this.fireEvent("resized",{ctx:this.ctx,size:this.#r,helper:this})}#h(){const e=t=>{const{offsetX:r,offsetY:n}=t,s=r*this.ratio,i=n*this.ratio;t=Qn(t);const a={physicalX:s,physicalY:i,...t};switch(t.type){case"pointerup":{this.fireEvent("pointerup",a);break}case"pointermove":{this.fireEvent("pointermove",a);break}case"pointerdown":{this.fireEvent("pointerup",a);break}}};this.el.addEventListener("pointermove",e),this.el.addEventListener("pointerdown",e),this.el.addEventListener("pointerup",e)}clear(){this.#s&&this.#s.clearRect(0,0,this.width,this.height)}fill(e){this.#s&&(e&&(this.#s.fillStyle=e),this.#s.fillRect(0,0,this.width,this.height))}get ctx(){if(this.#s===void 0)throw new Error("Context not available");return this.#o()}get viewport(){return this.#n}get width(){return this.#r.width}get height(){return this.#r.height}get size(){return this.#r}get ratio(){return window.devicePixelRatio||1}get dimensionMin(){return Math.min(this.width,this.height)}get dimensionMax(){return Math.max(this.width,this.height)}drawBounds(e="green"){const t=this.#o();nt(t,{x:0,y:0,width:this.width,height:this.height},{crossed:!0,strokeStyle:e,strokeWidth:1}),nt(t,this.#n,{crossed:!0,strokeStyle:"silver",strokeWidth:3})}get toRelative(){return this.#t.rel}get toAbsoluteFixed(){return this.#e.abs}get toRelativeFixed(){return this.#e.rel}get logicalCenter(){return{x:this.#r.width/2,y:this.#r.height/2}}get toAbsolute(){return this.#t.abs}get center(){return{x:this.width/2,y:this.height/2}}getImageData(){const e=this.getPhysicalSize(),t=this.ctx.getImageData(0,0,e.width,e.height,{colorSpace:this.opts.colourSpace});if(t==null)throw new Error("Could not get image data from context");return t}getWritableBuffer(){const e=this.ctx,t=this.getImageData(),r=be(t),n=Ue(t),s=nr(t);return{grid:r,get:n,set:s,flip:()=>{e.putImageData(t,0,0)}}}};const Si=Math.PI*2;var fn=class{#t;#e;#n;#r;#s;#i;#a=[];constructor(e,t="min"){this.#t=he(e),this.#n=t,this.#i=window.devicePixelRatio||1,this.#r=this.#c(),this.#s=this.setLogicalSize({width:this.#t.width,height:this.#t.height})}setLogicalSize(e){this.#s=e;const t=this.#t;return t.width=e.width*this.#i,t.height=e.height*this.#i,t.style.width=`${e.width.toString()}px`,t.style.height=`${e.height.toString()}px`,this.#r=this.#c(),this.invalidateContext(),e}#c(){let e=1;switch(this.#n){case"min":e=Math.min(this.#t.width,this.#t.height);break;case"max":e=Math.max(this.#t.width,this.#t.height);break}const t=Xn(0,e,0,1);return{abs:t.in,rel:t.out}}invalidateContext(){this.#e=void 0}#o(e){if(!e)throw new Error("Param 'region' is undefined/null");if(this.#a.includes(e))throw new Error("Region already exists");return this.#a.push(e),e}toAbsPoint(e,t="independent"){let{x:r,y:n}=e;switch(t){case"independent":r*=this.width,n*=this.height}return{x:r,y:n}}get offset(){const e=this.#t.getBoundingClientRect();return{x:e.left,y:e.top}}toRelPoint(e,t,r="independent",n=!0){let{x:s,y:i}=e;if(t==="screen"){const a=this.#t.getBoundingClientRect();s-=a.x,i-=a.y}switch(r){case"independent":s/=this.width,i/=this.height;break}return n&&(s=ee(s),i=ee(i)),{x:s,y:i}}toAbsRect(e,t="independent"){let{width:r,height:n}=e;switch(t){case"independent":if(r*=this.width,n*=this.height,gs(e))return{...this.toAbsPoint(e),width:r,height:n}}return{width:r,height:n}}createRegion(e){const t=e.marginPx??0,r=t*2;if("absPositioned"in e){const n=bs(e.absPositioned,t,t);return this.#o(new We(this,()=>n))}if("relativePositioned"in e){let n;const s=e.relativePositioned;switch(e.scale){case"independent":n=i=>({x:s.x*i.width+t,y:s.y*i.height+t,width:s.width*i.width-r,height:s.height*i.height-r});break;default:throw new Error(`Param 'kind' unknown (${e.scale})`)}return this.#o(new We(this,n))}if("relativeSize"in e){let n;const s=e.relativeSize,i=e.position;switch(e.scale){case"independent":n=a=>{const l=s.width*a.width-r,o=s.height*a.height-r;let c=a.width/2-l/2,h=a.height/2-o/2;switch(i){case"n":h=0;break;case"s":h=a.height-o;break}return c+=t,h+=t,{width:l,height:o,x:c,y:h}};break;default:throw new Error(`Param 'kind' unknown (${e.scale})`)}return this.#o(new We(this,n))}if("match"in e){const n=Ss(e.match);if(!n.success)throw new Error(`Could not resolve match element. ${Jn(n)}`);const s=i=>{const a=n.value.getBoundingClientRect();return{x:a.x+t,y:a.y+t,width:a.width-r,height:a.height-r}};return this.#o(new We(this,s))}throw new Error("Spec doesn't seem valid")}clear(){this.context.clearRect(0,0,this.width,this.height)}get context(){if(this.#e)return this.#e;const e=this.#t.getContext("2d");if(!e)throw new Error("Could not create 2d context");e.setTransform(1,0,0,1,0,0),e.scale(this.#i,this.#i),this.#e=e;for(const t of this.#a)t.recomputeRegion();return this.#e}get sizeScaler(){return this.#r}get width(){return this.#s.width}get height(){return this.#s.height}},We=class{source;#t;#e;constructor(e,t){this.source=e,this.#t=t,this.#e=t(e)}recomputeRegion(){this.#e=this.#t(this.source)}toAbsRegion(e,t="both"){switch(t){case"both":return{x:e.x*this.#e.width,y:e.y*this.#e.height}}}applyRegionOffset(e){return{x:e.x+this.#e.x,y:e.y+this.#e.y}}drawConnectedPointsRelative(e,t,r=1){const n=e.map(s=>this.toAbsRegion(s));this.drawConnectedPoints(n,t,r)}drawConnectedPoints(e,t,r=1){const n=this.context;n.save(),n.translate(this.#e.x,this.#e.y),n.beginPath(),n.strokeStyle=t,n.lineWidth=r;for(let s=0;s<e.length;s++)s===0?n.moveTo(e[s].x,e[s].y):n.lineTo(e[s].x,e[s].y);n.stroke(),n.restore()}fillTextRelative(e,t,r="black",n,s="alphabetic",i="start"){const a=this.toAbsRegion(t);this.fillTextRelative(e,a,r,n,s,i)}fillText(e,t,r="black",n,s="alphabetic",i="start"){const a=this.context;a.save(),a.translate(this.#e.x,this.#e.y),n.length>0&&(a.font=n),a.textBaseline=s,a.textAlign=i,a.fillStyle=r,a.fillText(e,t.x,t.y),a.restore()}drawCircles(e,t,r="",n=1){const s=e.map(a=>({...this.toAbsRegion(a),radius:this.source.sizeScaler.abs(a.radius)})),i=this.context;i.save(),i.translate(this.#e.x,this.#e.y),i.fillStyle=t,i.strokeStyle=r,i.lineWidth=n;for(const a of s)i.beginPath(),i.arc(a.x,a.y,a.radius,0,Si),i.closePath(),t.length>0&&i.fill(),r.length>0&&i.stroke();i.restore()}clear(){this.context.clearRect(this.#e.x,this.#e.y,this.#e.width,this.#e.height)}fill(e="white"){const t=this.context;t.fillStyle=e,t.fillRect(this.#e.x,this.#e.y,this.#e.width,this.#e.height)}drawBounds(e,t=1){this.drawConnectedPointsRelative([{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:0,y:0}],e,t),this.drawConnectedPointsRelative([{x:0,y:1},{x:1,y:0}],e,t),this.drawConnectedPointsRelative([{x:0,y:0},{x:1,y:1}],e,t)}toRelPoint(e,t="screen",r="independent",n=!0){e=this.source.toRelPoint(e,t,"skip",!1);let{x:s,y:i}=e;switch(s-=this.x,i-=this.y,r){case"independent":s/=this.width,i/=this.height}return n&&(s=ee(s),i=ee(i)),{x:s,y:i}}absToRegionPoint(e,t,r){t==="screen"&&(e=Ar(e,this.source.offset));let{x:n,y:s}=e;return n-=this.x,s-=this.y,r&&(n<0&&(n=0),s<0&&(s=0),n>this.width+this.x&&(n=this.x+this.width),s>this.height+this.y&&(s=this.y+this.height)),{x:n,y:s}}get center(){return ys(this.#e)}get context(){return this.source.context}set region(e){this.#e=e}get region(){return this.#e}get width(){return this.#e.width}get height(){return this.#e.height}get x(){return this.#e.x}get y(){return this.#e.y}get dimensionMin(){return Math.min(this.#e.width,this.#e.height)}};const _=(e,t)=>{t.fillStyle&&e.setAttributeNS(null,"fill",t.fillStyle),t.opacity&&e.setAttributeNS(null,"opacity",t.opacity.toString())},vi=e=>{const t=e.getAttributeNS(null,"width"),r=t===null?0:Number.parseFloat(t),n=e.getAttributeNS(null,"height"),s=n===null?0:Number.parseFloat(n);return{width:r,height:s}},Ci=(e,t)=>{e.setAttributeNS(null,"width",t.width.toString()),e.setAttributeNS(null,"height",t.height.toString())},Ct=(e,t)=>{const r=document.createElementNS("http://www.w3.org/2000/svg",e);return t&&(r.id=t),r},K=(e,t,r,n)=>{let s=null;if(r!==void 0&&(s=typeof r=="string"?e.querySelector(r):r),s===null){const i=document.createElementNS("http://www.w3.org/2000/svg",t);return e.append(i),r&&typeof r=="string"&&r.startsWith("#")&&(i.id=n!==void 0&&!r.endsWith(n)?r.slice(1)+n:r.slice(1)),i}return s},un=(e,t=.5,r=.75,n=1)=>{D(N(e,"positive","index"),N(t,"percentage","saturation"),N(r,"percentage","lightness"),N(n,"percentage","alpha"));const i=e*137.508%360/360;return at(fe(i,t,r,n))},Ai=(e=Math.random)=>e()*360;function Ae(e,t){return dn(e,r=>ee(r*t))}function dn(e,t){const r=At(e);let n;switch(r.space){case"hsl":n=Zr(r,t);break;case"srgb":n=on(r,t);break;case"oklch":n=nn(r,t);break;default:throw new Error(`Unknown space: '${r.space}'. Expected hsl, srgb, oklch`)}if(!n)throw new Error("Is colour in correct form?");return typeof e=="string"?T(n):n}function $i(e,t){const r=At(e);return r.opacity=t,typeof e=="string"?T(r):r}function Ri(e,t="hsl"){if(!Array.isArray(e))throw new Error(`Param 'colours' is not an array as expected. Got: ${typeof e}`);if(e.length<2)throw new Error(`Param 'colours' should be at least two in length. Got: ${e.length}`);const r=e.map(n=>lt(n,t));return[...Zn(r)]}const Ti=e=>`linear-gradient(to right, ${e.map(r=>T(r)).join(", ")})`,Pi=(e,t,r={})=>{const n=r.space??"oklch",s=r.direction??"shorter";let i;switch(n){case"hsl":i=Kt(E(e,"hsl-scalar"),E(t,"hsl-scalar"),s);break;case"srgb":i=rr(E(e,"srgb-scalar"),E(t,"srgb-scalar"));break;default:i=Xt(E(e,"oklch-scalar"),E(t,"oklch-scalar"),s)}return a=>T(i(a))},Ei=(e,t={})=>{const r=t.direction??"shorter",n=t.space??"oklch",s=Ri(e,n);let i=0;if(typeof t.stepsBetween=="number"){if(i=t.stepsBetween,i<1)throw new Error("Param 'stepsBetween' must be at least 1")}else if(typeof t.stepsTotal=="number"){if(t.stepsTotal<=e.length)throw new Error(`Param 'stepsTotal' must be greater than number of provided colour stops (${e.length}) +1 per stop`);const o=t.stepsTotal-e.length;i=Math.floor(o/s.length)}const a=s.map(o=>{const c=gn(o[0],o[1],{steps:i,space:n,direction:r,exclusive:!0});return c.push(o[1]),c}),l=s[0];return a.unshift([l[0]]),a.flat().map(o=>T(o))};function gn(e,t,r={}){const n=r.exclusive??!1,s=r.steps??5,i=r.space??"oklch",a=r.direction??"shorter";if(!n&&s<2)throw new Error("Param 'steps' should be at least 2 when 'exclusive' is false");if(n&&s<1)throw new Error("Param 'steps' should be at least 1 when 'exlusive' is true");const l=lt(e,i),o=lt(t,i);let c;switch(i){case"hsl":c=Kt(l,o,a);break;case"oklch":c=Xt(l,o,a);break;case"srgb":c=rr(l,o);break;default:throw new Error(`Colour space '${i}' not supported for interpolation.`)}if(!c)throw new Error(`Could not create interpolator for space: ${i}`);let h=0,u=0,p=1;n?(h=1/(s+1),u=h,p=1-h):h=1/(s-1);const b=[];for(let f=u;f<=p;f+=h)b.push(c(f));return b}var sr={};P(sr,{HslSpace:()=>Jr,OklchSpace:()=>en,SrgbSpace:()=>an,convert:()=>E,convertScalar:()=>lt,convertToString:()=>Ni,createSteps:()=>gn,cssDefinedHexColours:()=>z,cssLinearGradient:()=>Ti,fromCssColour:()=>Zt,goldenAngleColour:()=>un,guard:()=>bn,interpolator:()=>Pi,isColourish:()=>Or,isHsl:()=>re,isOkLch:()=>Se,isRgb:()=>O,multiplyOpacity:()=>Ae,randomHue:()=>Ai,resolveCss:()=>Qt,rgbToHsl:()=>Li,scale:()=>Ei,setOpacity:()=>$i,toColour:()=>At,toCssColour:()=>T,toHexColour:()=>Ii,toLibraryColour:()=>Mi,toStringFirst:()=>ce,tryParseObjectToHsl:()=>Ut,tryParseObjectToRgb:()=>Yt,withOpacity:()=>dn});function E(e,t){if(t==="hsl-scalar"){if(typeof e=="string"||re(e)||O(e))return ve(e)}else if(t==="hsl-absolute"){if(typeof e=="string"||re(e))return Ee(e)}else if(t==="oklch-scalar"){if(typeof e=="string"||Se(e))return ze(e)}else if(t==="oklch-absolute"){if(typeof e=="string"||Se(e))return vt(e)}else if(t==="srgb-8bit"){if(typeof e=="string"||O(e))return se(e)}else if(t==="srgb-scalar"){if(typeof e=="string"||O(e))return Ce(e)}else throw new Error(`Destination '${t}' not supported for input: ${JSON.stringify(e)}`);return E(T(e),t)}function Ni(e,t){const r=E(e,t);return T(r)}function lt(e,t){if(t==="oklch")return E(e,"oklch-scalar");if(t==="srgb")return E(e,"srgb-scalar");if(t==="hsl")return E(e,"hsl-scalar");throw new Error(`Unknown destination: '${t}'`)}const T=e=>{if(typeof e=="string")return e;if(re(e))return at(e);if(O(e))return He(e);if(Se(e))return tn(e);const t=Yt(e);if(t)return He(t);const r=Ut(e);if(r)return at(r);throw new Error(`Unknown colour format: '${JSON.stringify(e)}'`)},Ii=e=>{if(re(e))return Lt(e);if(O(e))return Ze(e);if(Se(e))return rn(e);if(typeof e=="string"){if(e.startsWith("#"))return e;const n=E(e,"srgb-8bit");return Ze(n)}const t=Yt(e);if(t)return Ze(t);const r=Ut(e);if(r)return Lt(r);throw new Error(`Unknown colour format: '${JSON.stringify(e)}'`)},Mi=e=>{const t=T(e);return new xt(t)},bn=e=>{switch(e.space){case"hsl":Ne(e);break;case"srgb":ge(e);break;case"oklch":de(e);break;default:throw new Error(`Unsupported colour space: '${e.space}'`)}},At=e=>{if(!Or(e))throw new Error(`Could not parse input. Expected CSS colour string or structured colour {r,g,b}, {h,s,l} etc. Got: ${JSON.stringify(e)}`);let t;if(typeof e=="string"?t=Zt(e):t=e,t===void 0)throw new Error("Could not parse input. Expected CSS colour string or structured colour {r,g,b}, {h,s,l} etc.");return bn(t),t},ce=(...e)=>{for(const t of e)if(t!==void 0&&t!==null)try{const r=At(t);return T(r)}catch{}return"rebeccapurple"};function Li(e,t){let{r,g:n,b:s}=e;const i=e.opacity??1;e.unit==="8bit"&&(r/=255,n/=255,s/=255);const a=Math.max(r,n,s),l=Math.min(r,n,s);let o=(a+l)/2,c=o;const h=o;if(a===l)return t?fe(0,0,0,i):Be(0,0,0,i);const u=a-l;switch(c=h>=.5?u/(2-(a+l)):u/(a+l),a){case r:o=((n-s)/u+0)*60;break;case n:o=((s-r)/u+2)*60;break;case s:o=((r-n)/u+4)*60;break}return t?fe(o/360,c,h,i):Be(o,c*100,h*100,i)}const X=(e,t)=>{t.strokeStyle&&e.setAttributeNS(null,"stroke",t.strokeStyle),t.strokeWidth&&e.setAttributeNS(null,"stroke-width",t.strokeWidth.toString()),t.strokeDash&&e.setAttribute("stroke-dasharray",t.strokeDash),t.strokeLineCap&&e.setAttribute("stroke-linecap",t.strokeLineCap)},yn=(e,t,r)=>{const n=Ct("marker",e);if(t.markerWidth&&n.setAttribute("markerWidth",t.markerWidth?.toString()),t.markerHeight&&n.setAttribute("markerHeight",t.markerHeight?.toString()),t.orient?n.setAttribute("orient",t.orient.toString()):n.setAttribute("orient","auto-start-reverse"),t.viewBox&&n.setAttribute("viewBox",t.viewBox.toString()),t.refX&&n.setAttribute("refX",t.refX.toString()),t.refY&&n.setAttribute("refY",t.refY.toString()),r){const s=r();n.appendChild(s)}return n},Qe=(e,t,r)=>{if(e===null)return"(elem null)";const n=e.ownerSVGElement;if(n===null)throw new Error("parent for elem is null");const s=K(n,"defs","defs");let i=s.querySelector(`#${t.id}`);if(i!==null)return`url(#${t.id})`;if(t.id==="triangle")t={...t,strokeStyle:"transparent"},t.markerHeight||(t={...t,markerHeight:6}),t.markerWidth||(t={...t,markerWidth:6}),t.refX||(t={...t,refX:t.markerWidth}),t.refY||(t={...t,refY:t.markerHeight}),(!t.fillStyle||t.fillStyle==="none")&&(t={...t,fillStyle:"black"}),t.viewBox||(t={...t,viewBox:"0 0 10 10"}),i=yn(t.id,t,()=>{const a=Ct("path");return a.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t&&_(a,t),a});else throw new Error(`Do not know how to make ${t.id}`);return i.id=t.id,s.appendChild(i),`url(#${t.id})`},$t=(e,t)=>{t.markerEnd&&e.setAttribute("marker-end",Qe(e,t.markerEnd)),t.markerStart&&e.setAttribute("marker-start",Qe(e,t.markerStart)),t.markerMid&&e.setAttribute("marker-mid",Qe(e,t.markerMid))};var wn={};P(wn,{circle:()=>ct,circleUpdate:()=>xn,grid:()=>$n,group:()=>Wi,groupUpdate:()=>kn,line:()=>ht,lineUpdate:()=>Sn,path:()=>pn,pathUpdate:()=>mn,polarRayUpdate:()=>Bi,text:()=>An,textPath:()=>Cn,textPathUpdate:()=>vn,textUpdate:()=>ir});const yr=e=>e>=0&&e<=1?`${e*100}%`:e.toString(),pn=(e,t,r,n)=>{const s=K(t,"path",n),i=typeof e=="string"?e:e.join(`
`);return s.setAttributeNS(null,"d",i),t.append(s),mn(s,r)},mn=(e,t)=>(t&&_(e,t),t&&X(e,t),e),xn=(e,t,r)=>(e.setAttributeNS(null,"cx",t.x.toString()),e.setAttributeNS(null,"cy",t.y.toString()),e.setAttributeNS(null,"r",t.radius.toString()),r&&_(e,r),r&&X(e,r),e),ct=(e,t,r,n)=>{const s=K(t,"circle",n);return xn(s,e,r)},Wi=(e,t,r)=>{const n=K(t,"g",r);return kn(n,e)},kn=(e,t)=>{for(const r of t)r.parentNode!==e&&e.append(r);return e},ht=(e,t,r,n)=>{const s=K(t,"line",n);return Sn(s,e,r)},Sn=(e,t,r)=>(e.setAttributeNS(null,"x1",t.a.x.toString()),e.setAttributeNS(null,"y1",t.a.y.toString()),e.setAttributeNS(null,"x2",t.b.x.toString()),e.setAttributeNS(null,"y2",t.b.y.toString()),r&&_(e,r),r&&$t(e,r),r&&X(e,r),e),Bi=(e,t,r)=>{const n=rs(t);return e.setAttributeNS(null,"x1",n.a.x.toString()),e.setAttributeNS(null,"y1",n.a.y.toString()),e.setAttributeNS(null,"x2",n.b.x.toString()),e.setAttributeNS(null,"y2",n.b.y.toString()),r&&_(e,r),r&&$t(e,r),r&&X(e,r),e},vn=(e,t,r)=>(r?.method&&e.setAttributeNS(null,"method",r.method),r?.side&&e.setAttributeNS(null,"side",r.side),r?.spacing&&e.setAttributeNS(null,"spacing",r.spacing),r?.startOffset&&e.setAttributeNS(null,"startOffset",yr(r.startOffset)),r?.textLength&&e.setAttributeNS(null,"textLength",yr(r.textLength)),t&&(e.textContent=t),r&&_(e,r),r&&X(e,r),e),Cn=(e,t,r,n,s,i)=>{const a=K(r,"text",s,"-text");ir(a,void 0,void 0,n);const l=K(a,"textPath",i);return l.setAttributeNS(null,"href",e),vn(l,t,n)},ir=(e,t,r,n)=>(t&&(e.setAttributeNS(null,"x",t.x.toString()),e.setAttributeNS(null,"y",t.y.toString())),r&&(e.textContent=r),n&&(_(e,n),n&&X(e,n),n.anchor&&e.setAttributeNS(null,"text-anchor",n.anchor),n.align&&e.setAttributeNS(null,"alignment-baseline",n.align),(n.userSelect??!0)||(e.style.userSelect="none")),e),An=(e,t,r,n,s)=>{const i=K(t,"text",s);return ir(i,r,e,n)},$n=(e,t,r,n,s,i={})=>{i.strokeStyle||(i={...i,strokeStyle:ce("bg-dim","silver")}),i.strokeWidth||(i={...i,strokeWidth:1});const a=Ct("g");_(a,i),$t(a,i),X(a,i);let l=0;for(;l<s;){const c=fr(0,l,n,l);ht(c,a),l+=r}let o=0;for(;o<n;){const c=fr(o,0,o,s);ht(c,a),o+=r}return e.append(a),a},Rn=e=>{if(!e)throw new Error("Param 'el' is undefined");const t={x:e.x1.baseVal.value,y:e.y1.baseVal.value},r={x:e.x2.baseVal.value,y:e.y2.baseVal.value};return{a:t,b:r}},zi=(e,t)=>{const r=Rn(e);return hs(r,t)},Tn=(e,t)=>{if(typeof t=="string"){const r=e.querySelector(t);if(r===null)return;r.remove()}else t.remove()},Fi=e=>{let t=e.lastElementChild;for(;t;)t.remove(),t=e.lastElementChild},Hi=(e,t)=>(t&&(_(e,t),X(e,t)),{remove:n=>{Tn(e,n)},text:(n,s,i,a)=>An(n,e,s,i,a),textPath:(n,s,i,a,l)=>Cn(n,s,e,i,a,l),line:(n,s,i)=>ht(n,e,s,i),circle:(n,s,i)=>ct(n,e,s,i),path:(n,s,i)=>pn(n,e,s,i),grid:(n,s,i,a,l)=>$n(e,n,s,i,a,l),query:n=>e.querySelector(n),get width(){const n=e.getAttributeNS(null,"width");return n===null?0:Number.parseFloat(n)},set width(n){e.setAttributeNS(null,"width",n.toString())},get parent(){return e},get height(){const n=e.getAttributeNS(null,"height");return n===null?0:Number.parseFloat(n)},set height(n){e.setAttributeNS(null,"height",n.toString())},clear:()=>{for(;e.firstChild;)e.lastChild.remove()}});var Pn={};P(Pn,{Elements:()=>wn,applyOpts:()=>_,applyPathOpts:()=>$t,applyStrokeOpts:()=>X,clear:()=>Fi,createEl:()=>Ct,createMarker:()=>yn,createOrResolve:()=>K,getBounds:()=>vi,lineFromSvgLine:()=>Rn,makeHelper:()=>Hi,markerPrebuilt:()=>Qe,polarRayFromSvgLine:()=>zi,remove:()=>Tn,setBounds:()=>Ci});const Di=(e,t={})=>{const r=t.touchRadius??45,n=t.touchRadius??20,s=t.trace??!1,i=t.hue??100,a=`hsla(${i}, 100%, 10%, 10%)`;let l=i;const o=he(e),c=new ds({storeIntermediate:s}),h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.id="pointerVis",h.style.zIndex="-1000",h.style.position="fixed",h.style.top="0",h.style.left="0",h.style.width="100%",h.style.height="100%",h.style.boxSizing="border-box",h.style.border="3px solid red",h.style.pointerEvents="none",h.style.touchAction="none",tt.svgViewport(h);let u=0;const p=f=>{const y=f.pointerId.toString();c.delete(y),l=i,h.querySelector(`#pv-start-${y}`)?.remove();for(let ie=0;ie<u+10;ie++)h.querySelector(`#pv-progress-${y}-${ie}`)?.remove();u=0},b=async f=>{const y=f.pointerId.toString(),ie={x:f.x,y:f.y},Ke=f.pointerType;if(f.type==="pointermove"&&!c.has(y))return;const A=await c.seen(f.pointerId.toString(),{x:f.clientX,y:f.clientY});if(A.values.length===1){const V=ct({...A.values[0],radius:Ke==="touch"?r:n},h,{fillStyle:a},`#pv-start-${y}`);V.style.pointerEvents="none",V.style.touchAction="none"}const ye=`hsla(${l}, 100%, 50%, 50%)`,j=ct({...ie,radius:Ke==="touch"?r:n},h,{fillStyle:ye},`#pv-progress-${y}-${A.values.length}`);j.style.pointerEvents="none",j.style.touchAction="none",l+=1,u=A.values.length};document.body.append(h),o.addEventListener("pointerdown",b),o.addEventListener("pointermove",b),o.addEventListener("pointerup",p),o.addEventListener("pointerleave",p),o.addEventListener("contextmenu",f=>{f.preventDefault()})};var En={};P(En,{boxBlurKernel:()=>Gi,convolve:()=>In,convolveCell:()=>Nn,convolveImage:()=>_i,edgeDetectionKernel:()=>Vi,gaussianBlur3Kernel:()=>Yi,gaussianBlur5Kernel:()=>Ui,identityKernel:()=>ji,kernel2dToArray:()=>Mn,multiply:()=>Oe,rgbReducer:()=>Ln,sharpenKernel:()=>qi,unsharpMasking5Kernel:()=>Oi});const Oe=(e,t)=>{const r=e.length,n=e[0].length,s=[];for(let i=0;i<r;i++){s[i]=[];for(let a=0;a<n;a++)s[i][a]=e[i][a]*t}return s};function Nn(e,t,r,n){const s=t.map(i=>{const a=ns(r,e,i.cell,"stop");let l;return a&&(l=r.get(a,"undefined"),i.value),{cell:i.cell,value:l,kernel:i.value}});return n(s)}function*_i(e,t){const r=hn(t);yield*In(e,r,ss(r),Ln)}function*In(e,t,r,n,s){if(!s){const a=e.length,l=e[0].length;s={x:Math.floor(a/2),y:Math.floor(l/2)}}const i=Mn(e,s);for(const a of r){const l=Nn(a,i,t,n);yield{cell:a,value:l}}}const Mn=(e,t)=>{const r=[],n=e.length,s=e[0].length;t||(t={x:Math.floor(n/2),y:Math.floor(s/2)});for(let i=0;i<n;i++)for(let a=0;a<s;a++){const l={cell:{x:i-t.x,y:a-t.y},value:e[i][a]};r.push(l)}return r},Ln=e=>{let t=0,r=0,n=0,s=0;for(const a of e){const l=a.value,o=a.kernel;l&&l.opacity!==0&&o!==0&&(t+=l.r*o,r+=l.g*o,n+=l.b*o,s+=(l.opacity??1)*o)}return{r:t,g:r,b:n,unit:"8bit",space:"srgb",opacity:s}},ji=[[0,0,0],[0,1,0],[0,0,0]],Vi=[[0,-1,0],[-1,4,-1],[0,-1,0]],qi=[[0,-1,0],[-1,5,-1],[0,-1,0]],Gi=Oe([[1,1,1],[1,1,1],[1,1,1]],1/9),Yi=Oe([[1,2,1],[2,4,2],[1,2,1]],1/16),Ui=Oe([[1,4,6,4,1],[4,16,24,16,4],[6,24,36,24,6],[4,16,24,16,4],[1,4,6,4,1]],1/256),Oi=Oe([[1,4,6,4,1],[4,16,24,16,4],[6,24,-476,24,6],[4,16,24,16,4],[1,4,6,4,1]],-1/256);var Wn={};P(Wn,{create:()=>Ki});const Ki=e=>new Xi(e);var Xi=class{#t=new Map;#e=new Map;fallbacks;#n=0;#r;constructor(e){e!==void 0?this.fallbacks=e:this.fallbacks=["red","blue","green","orange"],this.#r=document.body}setElementBase(e){this.#r=e}add(e,t){this.#t.set(e,t)}alias(e,t){this.#e.set(e,t)}get(e,t){const r=this.#e.get(e);r!==void 0&&(e=r);const n=this.#t.get(e);if(n!==void 0)return n;const s="--"+e;let i=getComputedStyle(this.#r).getPropertyValue(s).trim();if(i===void 0||i.length===0){if(t!==void 0)return t;i=this.fallbacks[this.#n],this.#n++,this.#n===this.fallbacks.length&&(this.#n=0)}return i}getOrAdd(e,t){if(this.has(e))return this.get(e);const r=this.get(e,t);return this.add(e,r),r}has(e){return this.#t.has(e)}},ar={};P(ar,{capture:()=>Zi,frames:()=>Ji,manualCapture:()=>Qi});async function*Ji(e,t={}){const r=t.maxIntervalMs??0,n=t.showCanvas??!1;let s=t.canvasEl,i,a;i=a=0,s===void 0&&(s=document.createElement("CANVAS"),s.classList.add("ixfx-frames"),n||(s.style.display="none"),document.body.appendChild(s));const l=()=>{s!==void 0&&(i=e.videoWidth,a=e.videoHeight,s.width=i,s.height=a)};let o=null;const c=is(r);for await(const h of c){if((i===0||a===0)&&l(),i===0||a===0)continue;if(o??=s.getContext("2d"),o===null)return;o.drawImage(e,0,0,i,a),yield o.getImageData(0,0,i,a)}}const Zi=(e,t={})=>{const r=t.maxIntervalMs??0,n=t.showCanvas??!1,s=t.onFrame,i=e.videoWidth,a=e.videoHeight,l=document.createElement("CANVAS");l.classList.add("ixfx-capture"),n||(l.style.display="none"),l.width=i,l.height=a;let o=null,c;t.workerScript&&(c=new Worker(t.workerScript));const h=c||s;!h&&!n&&console.warn("Video will be captured to hidden element without any processing. Is this what you want?");const u=as(()=>{if(o===null&&(o=l.getContext("2d")),o===null)return;o.drawImage(e,0,0,i,a);let p;if(h&&(p=o.getImageData(0,0,i,a)),c&&c.postMessage({pixels:p.data.buffer,width:i,height:a,channels:4},[p.data.buffer]),s)try{s(p)}catch(b){console.error(b)}},r);return{start:()=>{u.start()},cancel:()=>{u.cancel()},canvasEl:l}},Qi=(e,t={})=>{const r=t.showCanvas??!1,n=e.videoWidth,s=e.videoHeight,i=t.canvasEl!==void 0;let a=t.canvasEl;return a||(a=document.createElement("CANVAS"),a.classList.add("ixfx-capture"),document.body.append(a),r||(a.style.display="none")),a.width=n,a.height=s,{canvasEl:a,capture:()=>{let h;if(h||(h=a.getContext("2d",{willReadFrequently:!0})),!h)throw new Error("Could not create graphics context");h.drawImage(e,0,0,n,s);const u=h.getImageData(0,0,n,s);return u.currentTime=e.currentTime,t.postCaptureDraw&&t.postCaptureDraw(h,n,s),u},dispose:()=>{if(!i)try{a.remove()}catch{}}}};var Bn={};P(Bn,{init:()=>ea});function wr(e,t,r){const n=e.getAttribute(t);return n===null?r:Number.parseInt(n)}const ea=(e,t={})=>{const r=document.querySelector(e);if(!r)throw new Error(`Element query could not be found (${e})`);const n=t.labels??["x","y"],s=t.labelPrecision??2,i=t.asPercentages??!1,a=t.displayLastValues??0,l=t.showWhiskers??!0,o=t.showDot??!0,c=t.showLabels??!0,h=t.yAxisBottomNegative??!0,u=ce(t.axisColour,"silver"),p=ce(t.bgColour,"white"),b=ce(t.whiskerColour,"black"),f=ce(t.dotColour,t.whiskerColour,"black"),y=ce(t.labelColour,t.axisColour,"silver"),ie=t.axisWidth??1*window.devicePixelRatio,Ke=t.dotRadius??5*window.devicePixelRatio,A=t.padding??10*window.devicePixelRatio,ye=t.whiskerSize??5*window.devicePixelRatio,j=t.width??wr(r,"width",200)*window.devicePixelRatio,V=t.height??wr(r,"height",200)*window.devicePixelRatio;let ae;a>0&&(ae=new os({capacity:a,discardPolicy:"older"})),r.width=j,r.height=V,r.style.width=`${j/window.devicePixelRatio}px`,r.style.height=`${V/window.devicePixelRatio}px`;const Xe=V/2,we=j/2,w=r.getContext("2d");if(!w)throw new Error("Could not create drawing context");window.devicePixelRatio>=2&&(w.font="20px sans-serif");const or=i?M=>`${Math.round(M*100)}%`:M=>M.toFixed(s);c?(n[0]=n[0]+":",n[1]=n[1]+":"):(n[0]="",n[1]="");const Vn=t.renderBackground??((M,J,pe)=>{t.bgColour==="transparent"?M.clearRect(0,0,J,pe):(M.fillStyle=p,M.fillRect(0,0,J,pe))});return(M,J)=>{M=hr(M),J=hr(J),Vn(w,j,V),w.fillStyle=y,w.textBaseline="top",w.save(),w.translate(we,Xe),w.rotate(-Math.PI/2),w.fillText((n[1]+" "+or(J)).trim(),-we+A,1),w.restore(),w.fillText((n[0]+" "+or(M)).trim(),A,we+2),h||(J*=-1),w.strokeStyle=u,w.lineWidth=ie,w.beginPath(),w.moveTo(A,Xe),w.lineTo(j-A,Xe),w.moveTo(we,A),w.lineTo(we,V-A),w.stroke(),w.closePath();const pe=(V-A-A)/2*-J,Rt=(j-A-A)/2*M,lr={x:Rt,y:pe,radius:Ke};if(ae&&(ae=ae.enqueue(lr)),w.save(),w.translate(we,Xe),o)if(ae){const qn=1/ae.length;let cr=1;ae.forEach(Gn=>{const Yn=Ae(f,cr);rt(w,Gn,{fillStyle:Yn}),cr-=qn})}else rt(w,lr,{fillStyle:f});l&&(w.strokeStyle=b,w.beginPath(),w.moveTo(0,pe-ye),w.lineTo(0,pe+ye),w.moveTo(Rt-ye,0),w.lineTo(Rt+ye,0),w.stroke(),w.closePath()),w.restore()}},Bt=e=>{const t=e.map(c=>c.x),r=e.map(c=>c.y),n=Math.min(...t),s=Math.max(...t),i=Math.min(...r),a=Math.max(...r),l=s-n,o=a-i;return{min:{x:n,y:i},max:{x:s,y:a},width:l,height:o,minDim:Math.min(l,o),maxDim:Math.max(l,o)}},zn=e=>{if(!Number.isFinite(e.height))return n=>n;const t=et(e.min.x,e.max.x),r=et(e.min.y,e.max.y);return n=>({x:t(n.x),y:r(n.y)})},Fn=e=>{const t=et(0,1,e.min.x,e.max.x),r=et(0,1,e.min.y,e.max.y);return n=>({x:t(n.x),y:r(n.y)})},Hn=(e,t,r)=>{const n=[];let s=0;for(let a=e.min.x;a<e.max.x;a+=t){const l=s%r===0;n.push({x:a,y:0,major:l}),s++}s=0;const i=[];for(let a=e.min.y;a<e.max.y;a+=t){const l=s%r===0;i.push({x:0,y:a,major:l}),s++}return{x:n,y:i}};var Dn=class{#t;#e;lastChange;constructor(){this.lastChange=performance.now(),this.#t=new fs,this.#e=new Map}get metaCount(){return this.#e.size}clear(){this.#t.clear(),this.lastChange=performance.now()}set(e,t){this.#t.setValues(e,t)}deleteBySeries(e){const t=this.#t.delete(e);return t&&(this.lastChange=performance.now()),t}setMeta(e,t){this.#e.set(e,t)}hasMeta(e){return this.#e.has(e)}getMeta(e){return this.#e.get(e)}*getValues(){yield*this.#t.valuesFlat()}*getEntries(){yield*this.#t.entries()}*getSeries(){yield*this.#t.values()}add(e,t="default"){this.#t.addKeyedValues(t,e),this.lastChange=performance.now()}};const ta=(e,t={})=>{const r=e.parent===void 0?document.body:he(e.parent),n=document.createElement("canvas");r.prepend(n);const s=new Dn,i=new fn(n,"min"),a=e.region??{relativePositioned:{x:0,y:0,width:1,height:1}},l=i.createRegion(a),o=new _n(l,s,t);return e.canvasResizeTo==="viewport"?tt.canvasViewport(n,{onSizeChanging:(c,h)=>{i.setLogicalSize(c),o.invalidateRange(),o.draw()}}):tt.canvasParent(n,{onSizeChanging:(c,h)=>{i.setLogicalSize(c),o.invalidateRange(),o.draw()}}),o};var _n=class{#t;#e;#n;actualDataRange=Cr;visibleRange=us;show;whiskerLength;axisRounder=Kn(1,!0);onInvalidated;overlayLines=[];#r;#s;#i;#a;#c;#o;#f;#l;#h;#g;constructor(e,t,r={}){if(!t)throw new TypeError("Param 'data' is undefined");if(typeof t!="object")throw new TypeError(`Param 'data' is not an object. Got: ${typeof t}`);this.onInvalidated=r.onInvalidated,this.#t=t,this.#n=e,this.#e=0,this.#g=r.clear??"region",this.#s=r.range??"auto",this.#c=r.valueStyle??"dot",this.#o=r.connectStyle??"",this.whiskerLength=r.whiskerLength??5,this.#h=r.visualPadding??20,this.show={axes:!0,axisValues:!0,grid:!0,whiskers:!0,...r.show},this.#a={colour:"black",width:2,...r.axisStyle},this.#l={colour:"black",size:"1em",font:"system-ui",...r.textStyle},this.#r={increments:.1,major:5,colour:"whitesmoke",width:1,...r.grid}}getCurrentRange(){if(this.#t.lastChange===this.#e&&this.#i)return this.#i;this.#e=this.#t.lastChange;const e=this.#w();return this.#i=e,this.onInvalidated&&this.onInvalidated(),e}invalidateRange(){this.#i=void 0}#w(){const e=this.getDataRange(),t=zn(e),r=Fn(e),n=this.#n,s=this.#h;let i=n.x+s,a=n.y+s;const l=n.height-s*2,o=n.width-s*2,c=Math.min(l,o);return o>=l?i+=o/2-c/2:a+=l/2-c/2,{absDataToRelative:t,relDataToCanvas:b=>{let{x:f,y}=b;return f===Number.NEGATIVE_INFINITY?f=0:f===Number.POSITIVE_INFINITY&&(f=1),y===Number.NEGATIVE_INFINITY?y=0:y===Number.POSITIVE_INFINITY&&(y=1),f=f*c,y=(1-y)*c,f+=i,y+=a,{x:f,y}},canvasToRelData:b=>{let{x:f,y}=b;return f-=i,y-=a,f=f/c,y=1-y/c,{x:f,y}},regionSpaceToRelative:b=>{let{x:f,y}=b;return f=f-n.x+this.#h,y=c+this.#h-y,f/=c,y=y/c,{x:f,y}},relDataToAbs:r,range:e}}positionElementAt(e,t,r="middle",n){const s=he(t);let{x:i,y:a}=this.valueToScreenSpace(e);if(r==="middle"){const l=s.getBoundingClientRect();i-=l.width/2,a-=l.height/2}else if(r!=="top-left")throw new Error("Param 'by' expected to be 'middle' or 'top-left'.");if(n){const o=he(n).getBoundingClientRect();i-=o.x,a-=o.y}s.style.left=`${i}px`,s.style.top=`${a}px`}getDataRange(){return this.#s==="auto"?Bt([...this.#t.getValues()]):(this.#f||(this.#f=Bt([this.#s.max,this.#s.min])),this.#f)}valueToScreenSpace(e){const t=this.valueToRegionSpace(e),r=this.canvasSource.offset;return{x:t.x+r.x,y:t.y+r.y}}valueToRegionSpace(e,t=!1){const r=this.getCurrentRange(),n=r.absDataToRelative(e),s=r.relDataToCanvas(n);return t&&console.log(`orig: ${e.x}x${e.y} rel: ${n.x}x${n.y} region: ${s.x}x${s.y}`),{...e,x:s.x,y:s.y}}pointToValue(e,t){const r=this.getCurrentRange(),n=Ar(e,this.canvasSource.offset),s=r.canvasToRelData(n);return r.relDataToAbs(s)}#u(e,t,r=!1){return e=this.valueToRegionSpace(e,r),t=this.valueToRegionSpace(t,r),{a:e,b:t}}getDefaultMeta(){return{colour:un(this.#t.metaCount),lineWidth:2,dotRadius:5}}draw(){this.#g==="region"?this.#n.clear():this.canvasSource.clear(),this.#k(),this.show.axes&&this.#p();for(const[e,t]of this.#t.getEntries()){let r=this.#t.getMeta(e);r||(r=this.getDefaultMeta(),this.#t.setMeta(e,r)),this.#S(e,t,r)}for(const e of this.overlayLines)this.drawLine(e,e.colour,e.width)}drawLine(e,t,r){const n=this.#u(e.a,e.b);this.#d(n,t,r)}setMeta(e,t){this.#t.setMeta(e,{...this.getDefaultMeta(),...t})}#p(){const{colour:e,width:t}=this.#a,r=this.#u({x:0,y:Number.NEGATIVE_INFINITY},{x:0,y:Number.POSITIVE_INFINITY},!1),n=this.#u({x:Number.NEGATIVE_INFINITY,y:0},{x:Number.POSITIVE_INFINITY,y:0},!1);this.#d(n,e,t,!1),this.#d(r,e,t,!1)}#m(e){const t=this.#n.context;t.font=this.#l.size+" "+this.#l.font,t.fillStyle=this.#l.colour,t.textBaseline="middle";for(const r of e){if(r.x===0&&r.y===0)continue;const n=this.valueToRegionSpace(r,!1),i=this.axisRounder(r.y).toString(),a=t.measureText(i),l=n.x-a.width-this.whiskerLength/2-5,o=n.y;t.fillText(i,l,o)}}#x(e){const t=this.#n.context;t.font=this.#l.size+" "+this.#l.font,t.fillStyle=this.#l.colour,t.textBaseline="top";for(const r of e){const n=this.valueToRegionSpace(r,!1),i=this.axisRounder(r.x).toString(),a=t.measureText(i),l=n.x-a.width/2,o=n.y+a.actualBoundingBoxAscent+a.actualBoundingBoxDescent+this.whiskerLength/2;t.fillText(i,l,o)}}#b(e,t){const r=this.whiskerLength/2,n=t?{x:e.x,y:0}:{y:e.y,x:0},s=this.valueToRegionSpace(n,!1),i=t?{a:{x:s.x,y:s.y-r},b:{x:s.x,y:s.y+r}}:{a:{y:s.y,x:s.x-r},b:{y:s.y,x:s.x+r}};this.#d(i,this.#a.colour,this.#a.width,!1)}#y(e,t){const r=t?this.#u({x:e.x,y:Number.NEGATIVE_INFINITY},{x:e.x,y:Number.POSITIVE_INFINITY}):this.#u({y:e.y,x:Number.NEGATIVE_INFINITY},{y:e.y,x:Number.POSITIVE_INFINITY},!1);this.#d(r,this.#r.colour,e.major?this.#r.width*2:this.#r.width)}#k(){const e=this.#r,t=this.show.grid,r=this.show.whiskers,n=this.show.axisValues,s=this.getCurrentRange().range,{increments:i,major:a}=e,l=Hn(s,i,a);for(const o of l.x)t&&this.#y(o,!0),r&&o.major&&this.#b(o,!0);for(const o of l.y)t&&this.#y(o,!1),r&&o.major&&this.#b(o,!1);n&&(this.#x(l.x.filter(o=>o.major)),this.#m(l.y.filter(o=>o.major)))}#S(e,t,r){if(this.#o==="line"&&this.#v(t,r.colour,r.lineWidth),this.#c==="dot")for(const n of t)this.#C(n,r.colour,r.dotRadius)}#v(e,t,r){const n=this.#n.context;n.beginPath();for(const[s,i]of e.entries()){const a=this.valueToRegionSpace(i,!1);s===0&&n.moveTo(a.x,a.y),n.lineTo(a.x,a.y)}n.strokeStyle=T(t),n.lineWidth=r,n.stroke(),n.closePath()}#C(e,t,r){const n=T(e.fillStyle??t),s=this.valueToRegionSpace(e),i=e.radius??r;this.#n.drawCircles([{...s,radius:i}],n)}#d(e,t,r,n=!1){n&&console.log(e);const s=this.#n.context;t=T(t),s.beginPath(),s.moveTo(e.a.x,e.a.y),s.lineTo(e.b.x,e.b.y),s.strokeStyle=T(t),s.lineWidth=r,s.stroke(),s.closePath()}get dataSet(){return this.#t}get canvasRegion(){return this.#n}get canvasSource(){return this.#n.source}},jn={};P(jn,{BipolarView:()=>Bn,CartesianCanvasPlot:()=>_n,DataSet:()=>Dn,absoluteCompute:()=>Fn,computeAxisMark:()=>Hn,computeMinMax:()=>Bt,insert:()=>ta,relativeCompute:()=>zn});var ra={};P(ra,{CanvasHelper:()=>ki,CanvasRegion:()=>We,CanvasSource:()=>fn,Colour:()=>sr,Convolve2d:()=>En,Drawing:()=>$r,ImageDataGrid:()=>cn,Plot:()=>jn,Svg:()=>Pn,Video:()=>ar,pointerVisualise:()=>Di});try{typeof window<"u"&&(window.ixfx={...window.ixfx,Visuals:{NamedColourPalette:Wn,Colour:sr,Video:ar}})}catch{}export{T as a,At as b,qe as c,Gt as d,ne as e,Ve as f,_t as g,Te as h,Vt as i,_e as j,xt as k,Pe as l,Ae as m,je as o,Re as r,at as t};
